<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 第八讲：回归模型(一) | R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)</title>
  <meta name="description" content="课程bookdown" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 第八讲：回归模型(一) | R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="课程bookdown" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 第八讲：回归模型(一) | R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)" />
  
  <meta name="twitter:description" content="课程bookdown" />
  

<meta name="author" content="胡传鹏(等)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="第七讲描述性统计与数据可视化基础.html"/>
<link rel="next" href="第九讲回归模型二分层线性模型.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet" />
<script src="libs/panelset-0.2.6/panelset.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R语言在心理学研究中的应用</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>引言</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#开放电子书的初衷"><i class="fa fa-check"></i><b>0.1</b> 开放电子书的初衷</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#如何帮助完善本书"><i class="fa fa-check"></i><b>0.2</b> 如何帮助完善本书</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#使用许可"><i class="fa fa-check"></i><b>0.3</b> 使用许可</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#目录"><i class="fa fa-check"></i><b>0.4</b> 目录</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="关于作者.html"><a href="关于作者.html"><i class="fa fa-check"></i>关于作者</a>
<ul>
<li class="chapter" data-level="0.5" data-path="关于作者.html"><a href="关于作者.html#春季学期助教及电子书转录志愿者"><i class="fa fa-check"></i><b>0.5</b> 2024春季学期助教及电子书转录志愿者：</a></li>
<li class="chapter" data-level="0.6" data-path="关于作者.html"><a href="关于作者.html#春季学期助教"><i class="fa fa-check"></i><b>0.6</b> 2023春季学期助教：</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="lesson-1.html"><a href="lesson-1.html"><i class="fa fa-check"></i><b>1</b> 第一讲：为什么要学习R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="lesson-1.html"><a href="lesson-1.html#r在心理科学及社会科学中的运用"><i class="fa fa-check"></i><b>1.1</b> R在心理科学及社会科学中的运用</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="lesson-1.html"><a href="lesson-1.html#id_1-data-science"><i class="fa fa-check"></i><b>1.1.1</b> 数据科学</a></li>
<li class="chapter" data-level="1.1.2" data-path="lesson-1.html"><a href="lesson-1.html#id_1-data-science-born"><i class="fa fa-check"></i><b>1.1.2</b> 数据科学的诞生——数字化时代</a></li>
<li class="chapter" data-level="1.1.3" data-path="lesson-1.html"><a href="lesson-1.html#为什么要学习r语言1-why-learn-r"><i class="fa fa-check"></i><b>1.1.3</b> 为什么要学习R语言？{1-why-learn-R}</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="lesson-1.html"><a href="lesson-1.html#r语言使用的示例展示"><i class="fa fa-check"></i><b>1.2</b> R语言使用的示例展示</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="lesson-1.html"><a href="lesson-1.html#数据清洗"><i class="fa fa-check"></i><b>1.2.1</b> 数据清洗</a></li>
<li class="chapter" data-level="1.2.2" data-path="lesson-1.html"><a href="lesson-1.html#ggplot2画图"><i class="fa fa-check"></i><b>1.2.2</b> ggplot2画图</a></li>
<li class="chapter" data-level="1.2.3" data-path="lesson-1.html"><a href="lesson-1.html#心理学数据分析与结果汇报"><i class="fa fa-check"></i><b>1.2.3</b> 心理学数据分析与结果汇报</a></li>
<li class="chapter" data-level="1.2.4" data-path="lesson-1.html"><a href="lesson-1.html#regression"><i class="fa fa-check"></i><b>1.2.4</b> Regression</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lesson-1.html"><a href="lesson-1.html#现场运行代码"><i class="fa fa-check"></i><b>1.3</b> 现场运行代码</a></li>
<li class="chapter" data-level="1.4" data-path="lesson-1.html"><a href="lesson-1.html#课程安排"><i class="fa fa-check"></i><b>1.4</b> 课程安排</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="lesson-1.html"><a href="lesson-1.html#课程大纲"><i class="fa fa-check"></i><b>1.4.1</b> 课程大纲</a></li>
<li class="chapter" data-level="1.4.2" data-path="lesson-1.html"><a href="lesson-1.html#成绩分配"><i class="fa fa-check"></i><b>1.4.2</b> 成绩分配</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="lesson-1.html"><a href="lesson-1.html#如何学好这门课"><i class="fa fa-check"></i><b>1.5</b> 如何学好这门课</a></li>
<li class="chapter" data-level="1.6" data-path="lesson-1.html"><a href="lesson-1.html#课程总结与期望"><i class="fa fa-check"></i><b>1.6</b> 课程总结与期望</a></li>
<li class="chapter" data-level="1.7" data-path="lesson-1.html"><a href="lesson-1.html#推荐"><i class="fa fa-check"></i><b>1.7</b> 推荐</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html"><i class="fa fa-check"></i><b>2</b> 第二讲：如何开始使用R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#数据分析的出发点问题"><i class="fa fa-check"></i><b>2.1</b> 数据分析的出发点——问题</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#问题一-人类企鹅计划问卷数据"><i class="fa fa-check"></i><b>2.1.1</b> 问题一: 人类企鹅计划（问卷数据）</a></li>
<li class="chapter" data-level="2.1.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#问题二认知决策任务反应时和反应选择数据"><i class="fa fa-check"></i><b>2.1.2</b> 问题二：认知决策任务（反应时和反应选择数据）</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#如何安装r"><i class="fa fa-check"></i><b>2.2</b> 如何安装R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#r的下载与安装"><i class="fa fa-check"></i><b>2.2.1</b> R的下载与安装</a></li>
<li class="chapter" data-level="2.2.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#r-console控制台"><i class="fa fa-check"></i><b>2.2.2</b> R console（控制台）</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#如何安装rstudio"><i class="fa fa-check"></i><b>2.3</b> 如何安装Rstudio</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#rstuio的下载与安装"><i class="fa fa-check"></i><b>2.3.1</b> Rstuio的下载与安装</a></li>
<li class="chapter" data-level="2.3.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#测试rstudio"><i class="fa fa-check"></i><b>2.3.2</b> 测试Rstudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#创建新项目"><i class="fa fa-check"></i><b>2.3.3</b> 创建新项目</a></li>
<li class="chapter" data-level="2.3.4" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#包packages的介绍与调用"><i class="fa fa-check"></i><b>2.3.4</b> 包(packages)的介绍与调用</a></li>
<li class="chapter" data-level="2.3.5" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#镜像的选择"><i class="fa fa-check"></i><b>2.3.5</b> 镜像的选择</a></li>
<li class="chapter" data-level="2.3.6" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#安装rtoolswindows"><i class="fa fa-check"></i><b>2.3.6</b> 安装Rtools（windows）</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#如何通过和鲸model-whale使用r"><i class="fa fa-check"></i><b>2.4</b> 如何通过和鲸（Model Whale）使用R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html"><i class="fa fa-check"></i><b>3</b> 第三讲：Git &amp; RStudio工作流</a>
<ul>
<li class="chapter" data-level="3.1" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#文件与文件夹结构系统"><i class="fa fa-check"></i><b>3.1</b> 文件与文件夹结构系统</a></li>
<li class="chapter" data-level="3.2" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#git-and-git-hub"><i class="fa fa-check"></i><b>3.2</b> Git and Git Hub</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#git"><i class="fa fa-check"></i><b>3.2.1</b> Git</a></li>
<li class="chapter" data-level="3.2.2" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#git-hub"><i class="fa fa-check"></i><b>3.2.2</b> Git Hub</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#local-version-control"><i class="fa fa-check"></i><b>3.3</b> Local Version Control</a></li>
<li class="chapter" data-level="3.4" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#remote-version-control"><i class="fa fa-check"></i><b>3.4</b> Remote Version Control</a></li>
<li class="chapter" data-level="3.5" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#作业"><i class="fa fa-check"></i><b>3.5</b> 作业</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html"><i class="fa fa-check"></i><b>4</b> 第四讲：如何导入数据</a>
<ul>
<li class="chapter" data-level="4.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#正式开始前的tips"><i class="fa fa-check"></i><b>4.1</b> 正式开始前的Tips</a></li>
<li class="chapter" data-level="4.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#回顾与问题"><i class="fa fa-check"></i><b>4.2</b> 回顾与问题</a></li>
<li class="chapter" data-level="4.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据导入"><i class="fa fa-check"></i><b>4.3</b> 数据导入</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据的住址路径-以mac系统为例"><i class="fa fa-check"></i><b>4.3.1</b> 数据的“住址”——路径 (以Mac系统为例)</a></li>
<li class="chapter" data-level="4.3.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#绝对路径相对路径"><i class="fa fa-check"></i><b>4.3.2</b> 绝对路径/相对路径</a></li>
<li class="chapter" data-level="4.3.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#设定工作目录-手动挡与自动挡"><i class="fa fa-check"></i><b>4.3.3</b> 设定工作目录 – 手动挡与自动挡</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#读取数据"><i class="fa fa-check"></i><b>4.4</b> 读取数据</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#读取数据手动档"><i class="fa fa-check"></i><b>4.4.1</b> 读取数据——手动档</a></li>
<li class="chapter" data-level="4.4.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#读取数据自动挡gui点击操作"><i class="fa fa-check"></i><b>4.4.2</b> 读取数据——自动挡(GUI点击操作)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据类型"><i class="fa fa-check"></i><b>4.5</b> 数据类型</a></li>
<li class="chapter" data-level="4.6" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据结构"><i class="fa fa-check"></i><b>4.6</b> 数据结构</a></li>
<li class="chapter" data-level="4.7" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引"><i class="fa fa-check"></i><b>4.7</b> 数据索引</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引中括号"><i class="fa fa-check"></i><b>4.7.1</b> 数据索引(中括号)</a></li>
<li class="chapter" data-level="4.7.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引-1"><i class="fa fa-check"></i><b>4.7.2</b> 数据索引($)</a></li>
<li class="chapter" data-level="4.7.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引逻辑值"><i class="fa fa-check"></i><b>4.7.3</b> 数据索引(逻辑值)</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#对象object"><i class="fa fa-check"></i><b>4.8</b> 对象（object）</a></li>
<li class="chapter" data-level="4.9" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#其它注意事项"><i class="fa fa-check"></i><b>4.9</b> 其它注意事项</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#变量命名"><i class="fa fa-check"></i><b>4.9.1</b> 变量命名</a></li>
<li class="chapter" data-level="4.9.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#缺失值na-空值null"><i class="fa fa-check"></i><b>4.9.2</b> 缺失值（NA） 空值（NULL）</a></li>
<li class="chapter" data-level="4.9.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据类型的转换"><i class="fa fa-check"></i><b>4.9.3</b> 数据类型的转换</a></li>
<li class="chapter" data-level="4.9.4" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#目录和文件管理函数"><i class="fa fa-check"></i><b>4.9.4</b> 目录和文件管理函数:</a></li>
<li class="chapter" data-level="4.9.5" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#对象与变量名"><i class="fa fa-check"></i><b>4.9.5</b> 对象与变量名</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#final-project期末作业"><i class="fa fa-check"></i><b>4.10</b> final project（期末作业）</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#requirements"><i class="fa fa-check"></i><b>4.10.1</b> Requirements</a></li>
<li class="chapter" data-level="4.10.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#评分标准"><i class="fa fa-check"></i><b>4.10.2</b> 评分标准</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lesson-5.html"><a href="lesson-5.html"><i class="fa fa-check"></i><b>5</b> 第五讲：R语言中的对象2: 函数</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lesson-5.html"><a href="lesson-5.html#加载数据"><i class="fa fa-check"></i><b>5.1</b> 加载数据</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lesson-5.html"><a href="lesson-5.html#数据的地址路径"><i class="fa fa-check"></i><b>5.1.1</b> 数据的“地址”——路径</a></li>
<li class="chapter" data-level="5.1.2" data-path="lesson-5.html"><a href="lesson-5.html#绝对路径与相对路径"><i class="fa fa-check"></i><b>5.1.2</b> 绝对路径与相对路径</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lesson-5.html"><a href="lesson-5.html#读取数据-1"><i class="fa fa-check"></i><b>5.2</b> 读取数据</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lesson-5.html"><a href="lesson-5.html#手动导入"><i class="fa fa-check"></i><b>5.2.1</b> 手动导入</a></li>
<li class="chapter" data-level="5.2.2" data-path="lesson-5.html"><a href="lesson-5.html#代码导入"><i class="fa fa-check"></i><b>5.2.2</b> 代码导入</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lesson-5.html"><a href="lesson-5.html#赋值"><i class="fa fa-check"></i><b>5.3</b> 赋值</a></li>
<li class="chapter" data-level="5.4" data-path="lesson-5.html"><a href="lesson-5.html#数据类型-1"><i class="fa fa-check"></i><b>5.4</b> 数据类型</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="lesson-5.html"><a href="lesson-5.html#单个元素"><i class="fa fa-check"></i><b>5.4.1</b> 单个元素</a></li>
<li class="chapter" data-level="5.4.2" data-path="lesson-5.html"><a href="lesson-5.html#数值型numeric"><i class="fa fa-check"></i><b>5.4.2</b> 数值型(numeric)</a></li>
<li class="chapter" data-level="5.4.3" data-path="lesson-5.html"><a href="lesson-5.html#字符串character"><i class="fa fa-check"></i><b>5.4.3</b> 字符串(character)</a></li>
<li class="chapter" data-level="5.4.4" data-path="lesson-5.html"><a href="lesson-5.html#逻辑值logical"><i class="fa fa-check"></i><b>5.4.4</b> 逻辑值(logical)</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="lesson-5.html"><a href="lesson-5.html#数据结构-1"><i class="fa fa-check"></i><b>5.5</b> 数据结构</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="lesson-5.html"><a href="lesson-5.html#向量vector"><i class="fa fa-check"></i><b>5.5.1</b> 向量(vector)</a></li>
<li class="chapter" data-level="5.5.2" data-path="lesson-5.html"><a href="lesson-5.html#类型转换"><i class="fa fa-check"></i><b>5.5.2</b> 类型转换</a></li>
<li class="chapter" data-level="5.5.3" data-path="lesson-5.html"><a href="lesson-5.html#向量循环"><i class="fa fa-check"></i><b>5.5.3</b> 向量循环</a></li>
<li class="chapter" data-level="5.5.4" data-path="lesson-5.html"><a href="lesson-5.html#向量的索引"><i class="fa fa-check"></i><b>5.5.4</b> 向量的索引</a></li>
<li class="chapter" data-level="5.5.5" data-path="lesson-5.html"><a href="lesson-5.html#因子factor"><i class="fa fa-check"></i><b>5.5.5</b> 因子(factor)</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="lesson-5.html"><a href="lesson-5.html#数据框"><i class="fa fa-check"></i><b>5.6</b> 数据框</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="lesson-5.html"><a href="lesson-5.html#数据框的索引"><i class="fa fa-check"></i><b>5.6.1</b> 数据框的索引</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="lesson-5.html"><a href="lesson-5.html#矩阵与数组"><i class="fa fa-check"></i><b>5.7</b> 矩阵与数组</a></li>
<li class="chapter" data-level="5.8" data-path="lesson-5.html"><a href="lesson-5.html#列表"><i class="fa fa-check"></i><b>5.8</b> 列表</a></li>
<li class="chapter" data-level="5.9" data-path="lesson-5.html"><a href="lesson-5.html#函数"><i class="fa fa-check"></i><b>5.9</b> 函数</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="lesson-5.html"><a href="lesson-5.html#函数的调用"><i class="fa fa-check"></i><b>5.9.1</b> 函数的调用</a></li>
<li class="chapter" data-level="5.9.2" data-path="lesson-5.html"><a href="lesson-5.html#自定义函数"><i class="fa fa-check"></i><b>5.9.2</b> 自定义函数</a></li>
<li class="chapter" data-level="5.9.3" data-path="lesson-5.html"><a href="lesson-5.html#函数的组成"><i class="fa fa-check"></i><b>5.9.3</b> 函数的组成</a></li>
<li class="chapter" data-level="5.9.4" data-path="lesson-5.html"><a href="lesson-5.html#函数的简写"><i class="fa fa-check"></i><b>5.9.4</b> 函数的简写</a></li>
<li class="chapter" data-level="5.9.5" data-path="lesson-5.html"><a href="lesson-5.html#if-条件语句"><i class="fa fa-check"></i><b>5.9.5</b> if 条件语句</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html"><i class="fa fa-check"></i><b>6</b> 第六讲：数据预处理</a>
<ul>
<li class="chapter" data-level="6.1" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#tidyverse"><i class="fa fa-check"></i><b>6.1</b> <strong>Tidyverse</strong></a></li>
<li class="chapter" data-level="6.2" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#问卷数据"><i class="fa fa-check"></i><b>6.2</b> 问卷数据</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#研究问题数据情况"><i class="fa fa-check"></i><b>6.2.1</b> 研究问题&amp;数据情况</a></li>
<li class="chapter" data-level="6.2.2" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#操作步骤完整的管道操作"><i class="fa fa-check"></i><b>6.2.2</b> 操作步骤|完整的管道操作</a></li>
<li class="chapter" data-level="6.2.3" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#小结"><i class="fa fa-check"></i><b>6.2.3</b> 小结</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#反应时数据"><i class="fa fa-check"></i><b>6.3</b> 反应时数据</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#研究问题-数据情况"><i class="fa fa-check"></i><b>6.3.1</b> 研究问题 &amp; 数据情况</a></li>
<li class="chapter" data-level="6.3.2" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#操作步骤"><i class="fa fa-check"></i><b>6.3.2</b> 操作步骤</a></li>
<li class="chapter" data-level="6.3.3" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#小结-1"><i class="fa fa-check"></i><b>6.3.3</b> 小结</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html"><i class="fa fa-check"></i><b>7</b> 第七讲：描述性统计与数据可视化基础</a>
<ul>
<li class="chapter" data-level="7.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#回顾"><i class="fa fa-check"></i><b>7.1</b> 回顾</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#批量导入数据"><i class="fa fa-check"></i><b>7.1.1</b> 批量导入数据</a></li>
<li class="chapter" data-level="7.1.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#代码书写规范"><i class="fa fa-check"></i><b>7.1.2</b> 代码书写规范</a></li>
<li class="chapter" data-level="7.1.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#数据清洗-1"><i class="fa fa-check"></i><b>7.1.3</b> 数据清洗</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#探索性数据分析"><i class="fa fa-check"></i><b>7.2</b> 探索性数据分析</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#常用函数介绍"><i class="fa fa-check"></i><b>7.2.1</b> 常用函数介绍</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#数据可视化"><i class="fa fa-check"></i><b>7.3</b> 数据可视化</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#可视化的重要性"><i class="fa fa-check"></i><b>7.3.1</b> 可视化的重要性</a></li>
<li class="chapter" data-level="7.3.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#可视化的逻辑"><i class="fa fa-check"></i><b>7.3.2</b> 可视化的逻辑</a></li>
<li class="chapter" data-level="7.3.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#单个图片的组成"><i class="fa fa-check"></i><b>7.3.3</b> 单个图片的组成</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#常用图形"><i class="fa fa-check"></i><b>7.4</b> 常用图形</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#直方图"><i class="fa fa-check"></i><b>7.4.1</b> 直方图</a></li>
<li class="chapter" data-level="7.4.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#直方图密度图"><i class="fa fa-check"></i><b>7.4.2</b> 直方图+密度图</a></li>
<li class="chapter" data-level="7.4.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#箱线图"><i class="fa fa-check"></i><b>7.4.3</b> 箱线图</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#data-explorer"><i class="fa fa-check"></i><b>7.5</b> Data Explorer</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#data-explorer-1"><i class="fa fa-check"></i><b>7.5.1</b> Data Explorer</a></li>
<li class="chapter" data-level="7.5.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#使用ggpairs"><i class="fa fa-check"></i><b>7.5.2</b> 使用ggpairs</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#练习"><i class="fa fa-check"></i><b>7.6</b> 练习</a></li>
<li class="chapter" data-level="7.7" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#参考阅读"><i class="fa fa-check"></i><b>7.7</b> 参考阅读</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html"><i class="fa fa-check"></i><b>8</b> 第八讲：回归模型(一)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#研究问题"><i class="fa fa-check"></i><b>8.1</b> 研究问题</a></li>
<li class="chapter" data-level="8.2" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#t-test作为回归模型的特例"><i class="fa fa-check"></i><b>8.2</b> <em>t</em>-test作为回归模型的特例</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#独立样本t检验independent-t-test"><i class="fa fa-check"></i><b>8.2.1</b> 独立样本<em>t</em>检验(independent <em>t</em>-test)</a></li>
<li class="chapter" data-level="8.2.2" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#线性回归linear-regression"><i class="fa fa-check"></i><b>8.2.2</b> 线性回归(linear regression)</a></li>
<li class="chapter" data-level="8.2.3" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#单样本t检验one-sample-t-test"><i class="fa fa-check"></i><b>8.2.3</b> 单样本<em>t</em>检验(one sample <em>t</em>-test)</a></li>
<li class="chapter" data-level="8.2.4" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#配对样本t检验paired-t-test"><i class="fa fa-check"></i><b>8.2.4</b> 配对样本<em>t</em>检验(paired <em>t</em>-test)</a></li>
<li class="chapter" data-level="8.2.5" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#brucerttest"><i class="fa fa-check"></i><b>8.2.5</b> <code>bruceR::TTEST()</code></a></li>
<li class="chapter" data-level="8.2.6" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#总结"><i class="fa fa-check"></i><b>8.2.6</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#anova-linear-regression"><i class="fa fa-check"></i><b>8.3</b> ANOVA &amp; linear regression</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#研究问题-1"><i class="fa fa-check"></i><b>8.3.1</b> 研究问题</a></li>
<li class="chapter" data-level="8.3.2" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#代码实操-知识回顾"><i class="fa fa-check"></i><b>8.3.2</b> 代码实操 &amp; 知识回顾</a></li>
<li class="chapter" data-level="8.3.3" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#anova代码实操数据预处理"><i class="fa fa-check"></i><b>8.3.3</b> ANOVA代码实操|数据预处理</a></li>
<li class="chapter" data-level="8.3.4" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#代码实操正态性检验"><i class="fa fa-check"></i><b>8.3.4</b> 代码实操|正态性检验</a></li>
<li class="chapter" data-level="8.3.5" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#代码实操双因素被试间方差分析"><i class="fa fa-check"></i><b>8.3.5</b> 代码实操|双因素被试间方差分析</a></li>
<li class="chapter" data-level="8.3.6" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#代码实操平方和ss的计算"><i class="fa fa-check"></i><b>8.3.6</b> 代码实操|平方和(SS)的计算</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#线性回归"><i class="fa fa-check"></i><b>8.4</b> 线性回归</a></li>
<li class="chapter" data-level="8.5" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#知识延申单因素方差分析示例"><i class="fa fa-check"></i><b>8.5</b> 知识延申|单因素方差分析示例</a></li>
<li class="chapter" data-level="8.6" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#知识延申总结"><i class="fa fa-check"></i><b>8.6</b> 知识延申|总结</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html"><i class="fa fa-check"></i><b>9</b> 第九讲：回归模型(二)：分层线性模型</a>
<ul>
<li class="chapter" data-level="9.1" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#回顾-1"><i class="fa fa-check"></i><b>9.1</b> 回顾</a></li>
<li class="chapter" data-level="9.2" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#重复测量方差分析"><i class="fa fa-check"></i><b>9.2</b> 重复测量方差分析</a></li>
<li class="chapter" data-level="9.3" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#分层线性模型多层线性模型hlm"><i class="fa fa-check"></i><b>9.3</b> 分层线性模型/多层线性模型(HLM):</a></li>
<li class="chapter" data-level="9.4" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#多层线性模型的应用"><i class="fa fa-check"></i><b>9.4</b> 多层线性模型的应用</a></li>
<li class="chapter" data-level="9.5" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#hlm的应用"><i class="fa fa-check"></i><b>9.5</b> HLM的应用</a></li>
<li class="chapter" data-level="9.6" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#思考"><i class="fa fa-check"></i><b>9.6</b> 思考</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html"><i class="fa fa-check"></i><b>10</b> 第十讲：回归模型(三)：广义线性模型</a>
<ul>
<li class="chapter" data-level="10.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#前章回顾和本章数据预处理"><i class="fa fa-check"></i><b>10.1</b> 前章回顾和本章数据预处理</a></li>
<li class="chapter" data-level="10.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#广义线性模型"><i class="fa fa-check"></i><b>10.2</b> 广义线性模型</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#回归方程和普通线性模型"><i class="fa fa-check"></i><b>10.2.1</b> 回归方程和普通线性模型</a></li>
<li class="chapter" data-level="10.2.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#连接函数和广义线性模型"><i class="fa fa-check"></i><b>10.2.2</b> 连接函数和广义线性模型</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#二项分布"><i class="fa fa-check"></i><b>10.3</b> 二项分布</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#伯努利实验"><i class="fa fa-check"></i><b>10.3.1</b> 伯努利实验</a></li>
<li class="chapter" data-level="10.3.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#glm代码实操"><i class="fa fa-check"></i><b>10.3.2</b> GLM代码实操</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#不同方法比较"><i class="fa fa-check"></i><b>10.4</b> 不同方法比较</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#不同的建模方法"><i class="fa fa-check"></i><b>10.4.1</b> 不同的建模方法</a></li>
<li class="chapter" data-level="10.4.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#不同的模型比较方法"><i class="fa fa-check"></i><b>10.4.2</b> 不同的模型比较方法</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#其他分布"><i class="fa fa-check"></i><b>10.5</b> 其他分布</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html"><i class="fa fa-check"></i><b>11</b> 第十一讲：回归模型(四)：中介分析</a>
<ul>
<li class="chapter" data-level="11.1" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#准备工作"><i class="fa fa-check"></i><b>11.1</b> 准备工作</a></li>
<li class="chapter" data-level="11.2" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#线性模型回顾"><i class="fa fa-check"></i><b>11.2</b> 线性模型回顾</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#线性模型及模型检验"><i class="fa fa-check"></i><b>11.2.1</b> 线性模型及模型检验</a></li>
<li class="chapter" data-level="11.2.2" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#多元线性模型的局限"><i class="fa fa-check"></i><b>11.2.2</b> 多元线性模型的局限</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#中介分析"><i class="fa fa-check"></i><b>11.3</b> 中介分析</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#对于机制的表示图"><i class="fa fa-check"></i><b>11.3.1</b> 2.1 对于“机制”的表示——“图”</a></li>
<li class="chapter" data-level="11.3.2" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#中介分析-1"><i class="fa fa-check"></i><b>11.3.2</b> 中介分析</a></li>
<li class="chapter" data-level="11.3.3" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#中介效应"><i class="fa fa-check"></i><b>11.3.3</b> 中介效应</a></li>
<li class="chapter" data-level="11.3.4" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#中介效应的检验"><i class="fa fa-check"></i><b>11.3.4</b> 中介效应的检验</a></li>
<li class="chapter" data-level="11.3.5" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#问题提出"><i class="fa fa-check"></i><b>11.3.5</b> 问题提出</a></li>
<li class="chapter" data-level="11.3.6" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#代码实现"><i class="fa fa-check"></i><b>11.3.6</b> 代码实现</a></li>
<li class="chapter" data-level="11.3.7" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#process-in-brucer"><i class="fa fa-check"></i><b>11.3.7</b> PROCESS in bruceR()</a></li>
<li class="chapter" data-level="11.3.8" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#反思"><i class="fa fa-check"></i><b>11.3.8</b> 反思</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#因果推断"><i class="fa fa-check"></i><b>11.4</b> 因果推断</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#因果推断casual-inference"><i class="fa fa-check"></i><b>11.4.1</b> 因果推断(Casual Inference)</a></li>
<li class="chapter" data-level="11.4.2" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#因果推断与概率"><i class="fa fa-check"></i><b>11.4.2</b> 因果推断与概率</a></li>
<li class="chapter" data-level="11.4.3" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#基于实验的中介"><i class="fa fa-check"></i><b>11.4.3</b> 基于实验的中介</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#参考资料推荐"><i class="fa fa-check"></i><b>11.5</b> 参考资料推荐</a></li>
<li class="chapter" data-level="11.6" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#总结-1"><i class="fa fa-check"></i><b>11.6</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html"><i class="fa fa-check"></i><b>12</b> 第十二讲：数据可视化进阶</a>
<ul>
<li class="chapter" data-level="12.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#作图的必要性和作图数据处理"><i class="fa fa-check"></i><b>12.1</b> 作图的必要性和作图数据处理</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#为什么要进行可视化及可视化的原则"><i class="fa fa-check"></i><b>12.1.1</b> 为什么要进行可视化及可视化的原则</a></li>
<li class="chapter" data-level="12.1.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#作图数据准备"><i class="fa fa-check"></i><b>12.1.2</b> 作图数据准备</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#基础作图"><i class="fa fa-check"></i><b>12.2</b> 基础作图</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#ggplot2基础回顾"><i class="fa fa-check"></i><b>12.2.1</b> <code>ggplot2</code>基础回顾</a></li>
<li class="chapter" data-level="12.2.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#主要图层"><i class="fa fa-check"></i><b>12.2.2</b> 主要图层</a></li>
<li class="chapter" data-level="12.2.3" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#可选图层"><i class="fa fa-check"></i><b>12.2.3</b> 可选图层</a></li>
<li class="chapter" data-level="12.2.4" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#同时呈现多张图片"><i class="fa fa-check"></i><b>12.2.4</b> 同时呈现多张图片</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#进阶作图"><i class="fa fa-check"></i><b>12.3</b> 进阶作图</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#整体和个体效应共存的图"><i class="fa fa-check"></i><b>12.3.1</b> 整体和个体效应共存的图</a></li>
<li class="chapter" data-level="12.3.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#可视化层级模型的random-effect"><i class="fa fa-check"></i><b>12.3.2</b> 可视化层级模型的random effect</a></li>
<li class="chapter" data-level="12.3.3" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#雨云图rain-cloud-plot"><i class="fa fa-check"></i><b>12.3.3</b> 雨云图（rain cloud plot）</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#高级图片处理-magick"><i class="fa fa-check"></i><b>12.4</b> 高级图片处理 – <code>magick</code></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html"><i class="fa fa-check"></i><b>13</b> 第十三讲：基于网络模型的心理学研究</a>
<ul>
<li class="chapter" data-level="13.1" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#基于潜变量的心理学研究"><i class="fa fa-check"></i><b>13.1</b> 基于潜变量的心理学研究</a></li>
<li class="chapter" data-level="13.2" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#潜变量模型在心理学的困境"><i class="fa fa-check"></i><b>13.2</b> 潜变量模型在心理学的困境</a></li>
<li class="chapter" data-level="13.3" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#基于网络的心理学视角"><i class="fa fa-check"></i><b>13.3</b> 基于网络的心理学视角</a></li>
<li class="chapter" data-level="13.4" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#如果寻找可观测特征的因果关系"><i class="fa fa-check"></i><b>13.4</b> 如果寻找可观测特征的因果关系</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#d-separation"><i class="fa fa-check"></i><b>13.4.1</b> d-separation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#dag贝叶斯网络"><i class="fa fa-check"></i><b>13.5</b> DAG（贝叶斯网络）</a></li>
<li class="chapter" data-level="13.6" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#高斯图模型ggm"><i class="fa fa-check"></i><b>13.6</b> 高斯图模型（GGM）</a></li>
<li class="chapter" data-level="13.7" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#易辛模型ising-model"><i class="fa fa-check"></i><b>13.7</b> 易辛模型Ising model</a></li>
<li class="chapter" data-level="13.8" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#心理网络的估计"><i class="fa fa-check"></i><b>13.8</b> 心理网络的估计</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#高斯图模型"><i class="fa fa-check"></i><b>13.8.1</b> 高斯图模型</a></li>
<li class="chapter" data-level="13.8.2" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#多元估计"><i class="fa fa-check"></i><b>13.8.2</b> 多元估计</a></li>
<li class="chapter" data-level="13.8.3" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#一元估计"><i class="fa fa-check"></i><b>13.8.3</b> 一元估计</a></li>
<li class="chapter" data-level="13.8.4" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#代码实现-1"><i class="fa fa-check"></i><b>13.8.4</b> 代码实现</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#模型选择"><i class="fa fa-check"></i><b>13.9</b> 模型选择</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#模型选择的方式"><i class="fa fa-check"></i><b>13.9.1</b> 模型选择的方式</a></li>
<li class="chapter" data-level="13.9.2" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#代码实现-2"><i class="fa fa-check"></i><b>13.9.2</b> 代码实现</a></li>
<li class="chapter" data-level="13.9.3" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#代码实现-3"><i class="fa fa-check"></i><b>13.9.3</b> 代码实现</a></li>
<li class="chapter" data-level="13.9.4" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#代码实现-4"><i class="fa fa-check"></i><b>13.9.4</b> 代码实现</a></li>
<li class="chapter" data-level="13.9.5" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#总结-2"><i class="fa fa-check"></i><b>13.9.5</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#心理网络的挑战"><i class="fa fa-check"></i><b>13.10</b> 心理网络的挑战</a></li>
<li class="chapter" data-level="13.11" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#我们是否还需要潜变量模型"><i class="fa fa-check"></i><b>13.11</b> 我们是否还需要潜变量模型</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html"><i class="fa fa-check"></i><b>14</b> 第十四讲：心理学元分析入门</a>
<ul>
<li class="chapter" data-level="14.1" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html#什么是元分析"><i class="fa fa-check"></i><b>14.1</b> 什么是元分析</a></li>
<li class="chapter" data-level="14.2" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html#元分析的实施"><i class="fa fa-check"></i><b>14.2</b> 元分析的实施</a></li>
<li class="chapter" data-level="14.3" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html#回顾与总结"><i class="fa fa-check"></i><b>14.3</b> 回顾与总结</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="补充1如何进行基本的数据分析-相关与回归.html"><a href="补充1如何进行基本的数据分析-相关与回归.html"><i class="fa fa-check"></i><b>15</b> 补充1：如何进行基本的数据分析: 相关与回归</a>
<ul>
<li class="chapter" data-level="15.1" data-path="补充1如何进行基本的数据分析-相关与回归.html"><a href="补充1如何进行基本的数据分析-相关与回归.html#什么是相关"><i class="fa fa-check"></i><b>15.1</b> 什么是相关</a></li>
<li class="chapter" data-level="15.2" data-path="补充1如何进行基本的数据分析-相关与回归.html"><a href="补充1如何进行基本的数据分析-相关与回归.html#相关-代码实现"><i class="fa fa-check"></i><b>15.2</b> 相关-代码实现</a></li>
<li class="chapter" data-level="15.3" data-path="补充1如何进行基本的数据分析-相关与回归.html"><a href="补充1如何进行基本的数据分析-相关与回归.html#什么是回归"><i class="fa fa-check"></i><b>15.3</b> 什么是回归</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html"><i class="fa fa-check"></i><b>16</b> 补充2：从分析到手稿</a>
<ul>
<li class="chapter" data-level="16.1" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html#通过papaja撰写论文"><i class="fa fa-check"></i><b>16.1</b> <strong>通过Papaja撰写论文</strong></a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html#part1-papaja包的安装"><i class="fa fa-check"></i><b>16.1.1</b> <strong>Part1: Papaja包的安装</strong></a></li>
<li class="chapter" data-level="16.1.2" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html#part2-papaja语法格式"><i class="fa fa-check"></i><b>16.1.2</b> <strong>Part2: Papaja语法格式</strong></a></li>
<li class="chapter" data-level="16.1.3" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html#part3-正文的撰写"><i class="fa fa-check"></i><b>16.1.3</b> <strong>Part3: 正文的撰写</strong></a></li>
<li class="chapter" data-level="16.1.4" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html#总结-3"><i class="fa fa-check"></i><b>16.1.4</b> 总结</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html"><i class="fa fa-check"></i><b>17</b> 补充3：效应量和元分析</a>
<ul>
<li class="chapter" data-level="17.1" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html#效应量简介"><i class="fa fa-check"></i><b>17.1</b> 效应量简介</a></li>
<li class="chapter" data-level="17.2" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html#算法实现"><i class="fa fa-check"></i><b>17.2</b> 算法实现</a></li>
<li class="chapter" data-level="17.3" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html#小练习"><i class="fa fa-check"></i><b>17.3</b> 小练习</a></li>
<li class="chapter" data-level="17.4" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html#元分析简介"><i class="fa fa-check"></i><b>17.4</b> 元分析简介</a></li>
<li class="chapter" data-level="17.5" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html#元分析实现"><i class="fa fa-check"></i><b>17.5</b> 元分析实现</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第八讲回归模型一" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> 第八讲：回归模型(一)<a href="第八讲回归模型一.html#第八讲回归模型一" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>我们之前讨论的内容主要分为两方面。首先是学习R语言的一些基本知识，另一方面则是使用R代码来帮助我们解决描述性统计问题。如果大家还记得心理统计学中的内容，它分为描述统计和推断统计两部分。我们使用数据来进行统计推断，而R语言则可以帮助我们更灵活地实现各种统计方法。</p>
<p>纯粹的R代码学习 → 使用R语言来实现统计知识。当然，这种灵活性既有好处也有坏处。好处是我们有很多选择，坏处则是面对众多选择，我们可能会不知道如何选择。但是，如果我们能够度过刚开始不知道如何选择的阶段，后面就能更好地运用统计知识。另外，在接下来的课程中，我们将重点讨论回归模型，例如回归模型一、回归模型二和回归模型三。</p>
<p>我们之所以关注回归模型，是因为我们希望借此机会将大家在心理学、社会科学研究中常用的统计检验统一到回归框架下。这也是近年来一些研究者推荐的做法。实际上，心理学使用的统计方法与其他学科并没有本质区别，只是大家的偏好问题。在心理学领域中，最常用的方法便是各种回归模型的特例。</p>
<div id="研究问题" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> 研究问题<a href="第八讲回归模型一.html#研究问题" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>我们从研究问题开始，先来回顾一下人类企鹅计划的关键变量。其中一个是恋爱状态，另一个是核心温度，还有一个是社交复杂程度，以及赤道距离。在刚开始进行数据分析时，我们可能没有特别明确的假设，但我们想要了解社会关系，尤其是亲密关系，是否会影响我们的体温，是否能帮助我们调节核心温度。</p>
<p>我们可以使用我们知道的统计方法进行一些探索性分析，比如检验恋爱状态和赤道距离之间是否存在交互作用。大家还记得中介模型吗？其中一个变量是社交复杂程度，另一个是核心温度，中间有一个变量是赤道距离。研究发现，在不同的情侣关系群体中，这三个变量之间的关系是不一样的。</p>
<p>在接下来的课程中，我们将回顾一些关键概念，并进行一些常用的统计检验，包括<em>t</em>检验和方差分析。我们还将介绍为什么<em>t</em>检验和方差分析实际上是线性回归的特例。关于第一个研究问题，我们主要关注恋爱状态是否会影响核心体温。我们会比较两组不同的人，看他们的核心体温是否有差异。</p>
<p>基于恋爱状态，我们可以将数据分为两组：一组是处于恋爱或亲密关系中的人，另一组是没有处于亲密关系的人。我们想要比较这两组之间是否存在差异，通常会采用独立样本<em>t</em>检验。这是我们在学习过程中接触过的统计方法，大家应该都不陌生。</p>
<p><img src="pic/chp8/IJzerman2018fig.png" width="864" style="display: block; margin: auto;" />
(引自<a href="https://doi.org/10.1525/collabra.165">IJzerman et al., 2018</a>)</p>
</div>
<div id="t-test作为回归模型的特例" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> <em>t</em>-test作为回归模型的特例<a href="第八讲回归模型一.html#t-test作为回归模型的特例" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="独立样本t检验independent-t-test" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> 独立样本<em>t</em>检验(independent <em>t</em>-test)<a href="第八讲回归模型一.html#独立样本t检验independent-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>当然，我们需要了解一些基础知识，比如独立样本<em>t</em>检验。第一，我们需要满足正态性假设，即两个样本都来自正态总体。我们也知道，如果样本量足够大，即使不严格服从正态分布，使用<em>t</em>检验也是没有问题的。第二，我们还需要满足方差同质性假设，即两个样本的方差应该是类似的。第三，两个样本应该是独立的。</p>
<p>在进行独立样本<em>t</em>检验时，我们的零假设是这两个独立样本在某个变量上的均值没有差异，即μ1等于μ2。而我们的备择假设则是它们的总体均值是有差异的，即μ1不等于μ2。接下来，我们需要计算t值，这是进行<em>t</em>检验时通常需要用到的一个公式。</p>
<p><span class="math display">\[t = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}\]</span></p>
<p>在R语言中，如果我们要进行<em>t</em>检验，首先我们需要进行数据预处理。这包括清洗数据，处理缺失值，选择我们感兴趣的变量，以及生成新的变量等。</p>
<p>首先，我们可能需要为数据集生成一些新的变量，比如在原始数据中可能没有被试编号，我们可以随机生成。然后，我们选择自己在分析中关心的问题，使用dplyr函数选择我们感兴趣的变量。</p>
<p>在处理数据时，我们需要注意缺失值。在初步分析时，我们一般选择忽略缺失值，直接将其剔除，以便快速查看结果。此外，还需要将一些变量转换为因子，比如将是否处于亲密关系的变量转换为因子，并赋予两个水平：恋爱和单身。</p>
<p>接下来，我们关注的因变量是被试的体温，我们想知道在两组之间是否有差异。在原始数据中，有两次测量体温的数据，我们可以选择将两次测量的平均值作为新的变量，这可以通过R语言中的行函数实现。具体来说，我们可以创建一个新的变量，这个变量是以temperature字符串开头的列的平均值。</p>
<p>这些步骤都是数据预处理的一部分，是进行<em>t</em>检验之前必要的步骤。</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="第八讲回归模型一.html#cb283-1" tabindex="-1"></a>df.penguin <span class="ot">&lt;-</span> bruceR<span class="sc">::</span><span class="fu">import</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Book&quot;</span>,<span class="st">&#39;data&#39;</span>, <span class="st">&#39;penguin&#39;</span>, <span class="st">&#39;penguin_rawdata.csv&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb283-2"><a href="第八讲回归模型一.html#cb283-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">subjID =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb283-3"><a href="第八讲回归模型一.html#cb283-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(subjID,Temperature_t1, Temperature_t2, socialdiversity, </span>
<span id="cb283-4"><a href="第八讲回归模型一.html#cb283-4" tabindex="-1"></a>                Site, DEQ, romantic, ALEX1<span class="sc">:</span>ALEX16) <span class="sc">%&gt;%</span>                                     <span class="co"># 选择变量</span></span>
<span id="cb283-5"><a href="第八讲回归模型一.html#cb283-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Temperature_t1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Temperature_t2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(DEQ)) <span class="sc">%&gt;%</span>         <span class="co"># 处理缺失值</span></span>
<span id="cb283-6"><a href="第八讲回归模型一.html#cb283-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">romantic =</span> <span class="fu">factor</span>(romantic, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;恋爱&quot;</span>, <span class="st">&quot;单身&quot;</span>)),  <span class="co"># 转化为因子</span></span>
<span id="cb283-7"><a href="第八讲回归模型一.html#cb283-7" tabindex="-1"></a>                <span class="at">Temperature =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">&quot;Temperature&quot;</span>))),             <span class="co"># 计算两次核心温度的均值</span></span>
<span id="cb283-8"><a href="第八讲回归模型一.html#cb283-8" tabindex="-1"></a>                <span class="at">ALEX4  =</span> <span class="fu">case_when</span>(<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">6</span> <span class="sc">-</span> ALEX4),</span>
<span id="cb283-9"><a href="第八讲回归模型一.html#cb283-9" tabindex="-1"></a>                <span class="at">ALEX12 =</span> <span class="fu">case_when</span>(<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">6</span> <span class="sc">-</span> ALEX12),</span>
<span id="cb283-10"><a href="第八讲回归模型一.html#cb283-10" tabindex="-1"></a>                <span class="at">ALEX14 =</span> <span class="fu">case_when</span>(<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">6</span> <span class="sc">-</span> ALEX14),</span>
<span id="cb283-11"><a href="第八讲回归模型一.html#cb283-11" tabindex="-1"></a>                <span class="at">ALEX16 =</span> <span class="fu">case_when</span>(<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">6</span> <span class="sc">-</span> ALEX16),</span>
<span id="cb283-12"><a href="第八讲回归模型一.html#cb283-12" tabindex="-1"></a>                <span class="at">ALEX   =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">&quot;ALEX&quot;</span>)))) <span class="co"># 反向计分后计算总分</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-02fec53c9676ba7a07e8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-02fec53c9676ba7a07e8">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6"],[1,2,3,4,5,6],[36.8,34.2,35,36.1,35.72222222,35.3],[36.7,36.6,35.2,35.8,36.44444444,35.9],[8,6,5,7,5,7],["Tsinghua","Oxford","Oxford","Oxford","Chile","Bamberg"],[26.88780212,51.75,51.75,51.75,42.07719421,51.65660095],["单身","恋爱","恋爱","恋爱","恋爱","恋爱"],[2,1,2,3,1,1],[2,1,2,4,1,2],[2,1,4,1,1,1],[4,5,4,4,5,4],[2,1,2,4,1,1],[2,1,2,2,1,3],[2,1,2,3,2,4],[2,1,2,4,1,2],[2,1,2,2,2,4],[1,1,1,1,1,2],[2,1,2,2,1,2],[4,4,3,4,4,2],[2,3,2,2,2,4],[4,4,4,4,4,5],[2,3,2,4,1,1],[4,4,4,4,2,5],[36.75,35.40000000000001,35.1,35.95,36.08333333,35.59999999999999],[31,23,34,40,24,35]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>subjID<\/th>\n      <th>Temperature_t1<\/th>\n      <th>Temperature_t2<\/th>\n      <th>socialdiversity<\/th>\n      <th>Site<\/th>\n      <th>DEQ<\/th>\n      <th>romantic<\/th>\n      <th>ALEX1<\/th>\n      <th>ALEX2<\/th>\n      <th>ALEX3<\/th>\n      <th>ALEX4<\/th>\n      <th>ALEX5<\/th>\n      <th>ALEX6<\/th>\n      <th>ALEX7<\/th>\n      <th>ALEX8<\/th>\n      <th>ALEX9<\/th>\n      <th>ALEX10<\/th>\n      <th>ALEX11<\/th>\n      <th>ALEX12<\/th>\n      <th>ALEX13<\/th>\n      <th>ALEX14<\/th>\n      <th>ALEX15<\/th>\n      <th>ALEX16<\/th>\n      <th>Temperature<\/th>\n      <th>ALEX<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,6,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"subjID","targets":1},{"name":"Temperature_t1","targets":2},{"name":"Temperature_t2","targets":3},{"name":"socialdiversity","targets":4},{"name":"Site","targets":5},{"name":"DEQ","targets":6},{"name":"romantic","targets":7},{"name":"ALEX1","targets":8},{"name":"ALEX2","targets":9},{"name":"ALEX3","targets":10},{"name":"ALEX4","targets":11},{"name":"ALEX5","targets":12},{"name":"ALEX6","targets":13},{"name":"ALEX7","targets":14},{"name":"ALEX8","targets":15},{"name":"ALEX9","targets":16},{"name":"ALEX10","targets":17},{"name":"ALEX11","targets":18},{"name":"ALEX12","targets":19},{"name":"ALEX13","targets":20},{"name":"ALEX14","targets":21},{"name":"ALEX15","targets":22},{"name":"ALEX16","targets":23},{"name":"Temperature","targets":24},{"name":"ALEX","targets":25}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[4,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>要在R语言中进行<em>t</em>检验，我们可以使用自带的stats包中的<code>t.test()</code>函数。这是一个非常常用的<em>t</em>检验函数。在使用<code>t.test()</code>函数时，我们需要输入一些参数。第一个参数是经过筛选的数据框，第二个参数是我们感兴趣的自变量（如temp），第三个参数是分组变量（如romantic）。此外，我们还可以假定两组的方差是相等的。运行<code>t.test()</code>函数后，我们可以得到结果，包括t值、自由度（df）和p值。在这个例子中，t值为0.34664，自由度为1425，而p值较大，表示在恋爱组和非恋爱组之间的体温差异不显著。从结果来看，恋爱状态对体温的影响似乎并不大。</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="第八讲回归模型一.html#cb284-1" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">t.test</span>(<span class="at">data =</span> df.penguin,      <span class="co"># 数据框</span></span>
<span id="cb284-2"><a href="第八讲回归模型一.html#cb284-2" tabindex="-1"></a>              Temperature <span class="sc">~</span> romantic, <span class="co"># 因变量~自变量</span></span>
<span id="cb284-3"><a href="第八讲回归模型一.html#cb284-3" tabindex="-1"></a>              <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb284-4"><a href="第八讲回归模型一.html#cb284-4" tabindex="-1"></a>  <span class="fu">capture.output</span>()                    <span class="co"># 将输出变整齐</span></span></code></pre></div>
<pre><code>##  [1] &quot;&quot;                                                                                                    
##  [2] &quot;\tTwo Sample t-test&quot;                                                                                 
##  [3] &quot;&quot;                                                                                                    
##  [4] &quot;data:  Temperature by romantic&quot;                                                                      
##  [5] &quot;t = -0.347, df = 1425, p-value = 0.73&quot;                                                               
##  [6] &quot;alternative hypothesis: true difference in means between group 恋爱 and group 单身 is not equal to 0&quot;
##  [7] &quot;95 percent confidence interval:&quot;                                                                     
##  [8] &quot; -0.055595  0.038897&quot;                                                                                
##  [9] &quot;sample estimates:&quot;                                                                                   
## [10] &quot;mean in group 恋爱 mean in group 单身 &quot;                                                              
## [11] &quot;            36.385             36.393 &quot;                                                              
## [12] &quot;&quot;</code></pre>
<p>当然，除了<code>t.test()</code>函数，还有其他方法可以进行类似的分析。不过，在这个简单的示例中，<code>t.test()</code>已经足够满足我们的需求。</p>
<p>我们说<em>t</em>检验是一个特殊的线性回归模型，这是因为在R语言中，它们的编写方式非常相似。在回归模型中，我们将自变量放在前面，因变量放在后面。为了理解这个概念，我们需要简要回顾一下线性回归模型。</p>
<p>线性回归模型是一种统计方法，用于研究一个或多个变量能否预测或解释另一个变量。我们将用来预测的变量称为预测变量或自变量，而被预测的变量称为因变量或响应变量。线性回归的核心是通过拟合一条直线来表示两个变量之间的关系，使得直线与每个数据点之间的距离最小。这样，我们便可以利用这条直线来进行预测。</p>
<p>我们通常会用一个方程或等式来表示线性回归模型，如y = β0 + β1x1 + β2x2 + … + ε。其中y是我们关心的因变量，x1、x2等是自变量，β0、β1、β2等是回归系数，而ε是误差项。</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \epsilon\]</span></p>
<p>在学习线性回归时，我们通常关注连续变量之间的关系。这意味着x和y都是连续变量。而在<em>t</em>检验中，我们关注的是分组变量，这似乎与线性回归有所不同。然而，在特定情况下，我们可以将<em>t</em>检验视为线性回归的一个特例。当我们分析的自变量是一个二分类变量时，线性回归模型实际上等同于独立样本<em>t</em>检验。所以，虽然它们在某些方面有所不同，但<em>t</em>检验确实可以看作是线性回归的一个特殊情况。</p>
</div>
<div id="线性回归linear-regression" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> 线性回归(linear regression)<a href="第八讲回归模型一.html#线性回归linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在<em>t</em>检验中，我们的因变量，比如体温，是连续的，而自变量，比如是否处于亲密关系，是二分类的。这似乎与我们通常的线性回归模型有所不同，因为在线性回归中，我们通常关注的是连续变量之间的关系。然而，实际上，当我们的自变量是二分类变量时，我们也可以将其视为线性回归模型的一个特例。</p>
<p>想象一下，我们在图上有两堆数据点，一堆是处于亲密关系的人的体温，另一堆是非恋爱状态的人的体温。在这两堆数据点之间，我们可以拟合出一条回归线，这条线可以帮助我们进行预测。当x=1（处于亲密关系）时，我们预测的y值（体温）是多少？当x=2（非恋爱状态）时，我们预测的y值是多少？</p>
<p>在常规的线性回归中，x可以有很多值，y也可以有很多值。然而，在<em>t</em>检验中，x只有两个值，一个是1，一个是2（或者0和1）。我们要做的预测也是，当x=1时，y是多少？当x=2时，y是多少？这就是为什么我们说独立样本<em>t</em>检验是线性回归模型的一个特例，特别是当我们的自变量是二分变量时。</p>
<p>在R语言中，我们可以通过代码来验证这个观点。无论我们是使用<code>t.test()</code>函数进行<em>t</em>检验，还是使用lm函数进行线性回归，我们得到的结果应该是一样的。这是因为在这种特殊情况下，这两种方法本质上是在做同样的事情。</p>
<p><img src="pic/chp8/indet-lm.png" width="55%"></p>
<p>实际上，在进行线性回归时，我们可以采用不同的编码方法来表示分类变量。比如，对于二分类变量，我们可以将其编码为0和1。当我们采用这种编码方式时，线性回归方程为y = β0 + β1x1。其中，x1只有两个可能的取值：0和1。当x1 = 0时，y = β0。当x1 = 1时，y = β0 + β1。这样，我们可以看到，β1实际上表示了两组之间的差异。当然，这只是一种方便我们理解的编码方式。在实际应用中，我们可能会遇到更复杂的编码方法，比如虚拟变量编码、效应编码等。这些编码方法在处理多分类变量时尤为有用。</p>
<p>总之，独立样本<em>t</em>检验实际上可以看作是线性回归模型的一个特例，特别是当我们的自变量是二分变量时。无论我们是使用<code>t.test()</code>函数进行<em>t</em>检验，还是使用lm函数进行线性回归，我们得到的结果应该是一样的。这是因为在这种特殊情况下，这两种方法本质上是在做同样的事情。</p>
<p>首先，我们进行预处理数据。这个过程相对简单，大家应该都能理解。接下来，我们来看一下<em>t</em>检验。假设我们不对结果进行整理，而是直接查看原始输出，那么我们会看到以下内容：t值是多少，df值是多少，以及p值是多少。我们之前提到过，<em>t</em>检验实际上是一种特殊的回归。</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="第八讲回归模型一.html#cb286-1" tabindex="-1"></a><span class="co"># *t*检验</span></span>
<span id="cb286-2"><a href="第八讲回归模型一.html#cb286-2" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">t.test</span>(</span>
<span id="cb286-3"><a href="第八讲回归模型一.html#cb286-3" tabindex="-1"></a>  <span class="at">data =</span> df.penguin,</span>
<span id="cb286-4"><a href="第八讲回归模型一.html#cb286-4" tabindex="-1"></a>  Temperature <span class="sc">~</span> romantic,</span>
<span id="cb286-5"><a href="第八讲回归模型一.html#cb286-5" tabindex="-1"></a>  <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb286-6"><a href="第八讲回归模型一.html#cb286-6" tabindex="-1"></a>  <span class="fu">capture.output</span>() <span class="co"># 将输出变整齐</span></span></code></pre></div>
<p><img src="pic/chp8/compare1.1.png" width="100%"></p>
<p>我们继续讨论回归模型。在R语言中，线性回归模型的常用函数是lm。我们可以通过比较<em>t</em>检验和线性回归模型得到的t值、df值和p值来判断它们是否相同。</p>
<p>在这个地方，大家可以看到我们使用的是stats包的lm代码，这个代码代表线性回归模型。我们在这里还是采用同样的数据，然后使用回归模型的公式。在这个公式中，temp是我们的因变量y，而romantics是我们的自变量x。这个x是一个因子，我们需要将其转换为因子。在编写这个公式时，我们只需在因变量前加上一个波浪号，然后加上自变量。接下来，lm函数会自动帮助我们处理因子变量在回归分析中的一些后续处理。最后，它会给我们一个结果。</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="第八讲回归模型一.html#cb287-1" tabindex="-1"></a><span class="co"># 线性回归</span></span>
<span id="cb287-2"><a href="第八讲回归模型一.html#cb287-2" tabindex="-1"></a>model.inde <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(</span>
<span id="cb287-3"><a href="第八讲回归模型一.html#cb287-3" tabindex="-1"></a>  <span class="at">data =</span> df.penguin,</span>
<span id="cb287-4"><a href="第八讲回归模型一.html#cb287-4" tabindex="-1"></a>  <span class="at">formula =</span> Temperature <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> romantic</span>
<span id="cb287-5"><a href="第八讲回归模型一.html#cb287-5" tabindex="-1"></a>  )</span>
<span id="cb287-6"><a href="第八讲回归模型一.html#cb287-6" tabindex="-1"></a><span class="fu">summary</span>(model.inde)</span></code></pre></div>
<p><img src="pic/chp8/compare1.2.png" width="100%"></p>
<p>我们可以看到，这里的t值、p值与我们之前的结果基本相同（t值为0.347，p值为0.729）。这是因为我们主要关注的是单身对结果的影响。因此，我们可以得出这样的结论：两组之间的差异在<em>t</em>检验和回归模型中表现得相当一致。在回归模型中，可能还会有一个intercept，但我们通常不会关注它。斜率slope代表的含义是当x从一个单位变化到另一个单位时，我们的因变量y会发生多少变化。而对于我们这种只有二分变量的自变量的情况，就代表两组之间的差异。</p>
<p>因此，我们可以说，二分变量的<em>t</em>检验与回归模型之间存在密切关系。我们关注的是回归系数，它的统计检验值与<em>t</em>检验中的值完全相同。这就是我们希望展示的结果。所以，在心理学中常用的<em>t</em>检验实际上是线性回归的一种特殊情况。</p>
<p>那当然，这里涉及到一个知识点，我们没有详细展开讲，但大家以后感兴趣的话可以去了解。这个知识点就是编码方法。因为我们的数据有两个水平，可能有多种编码方法。例如，我们可以把一个水平编码为0，另一个水平编码为1。那么我们的公式可以表示为：y = β0 + β1 * x1。在这个情况下，x1只有两种取值：0和1。当x=0时，y等于β0；当x=1时，y等于β0 + β1。所以这个时候我们可以看出β1就是两组之间的区别。</p>
<p>当然，这只是一种方便我们理解的方法。另外一种常用的编码方法是将x1编码为-0.5和0.5。在这种情况下，对β的解读就不一样了。大家可以将这种编码带入公式后，自己去观察一下。我们在这里就不展开详细讲解了，因为我们主要想向大家介绍这个概念。大家可以在R语言中多探索一下这个知识点，以便更好地理解和应用。</p>
</div>
<div id="单样本t检验one-sample-t-test" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> 单样本<em>t</em>检验(one sample <em>t</em>-test)<a href="第八讲回归模型一.html#单样本t检验one-sample-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>那么同理，一系列的<em>t</em>检验其实都可以认为是回归模型的特例。例如，我们来看单样本<em>t</em>检验。虽然我们平时很少使用单样本<em>t</em>检验，但在某些情况下，它还是有用的。比如，我们想要判断某个班级的成绩是否属于全校成绩的总体。在这种情况下，我们实际上是在比较这个班级的成绩均值和全校的总体均值。</p>
<p>在单样本<em>t</em>检验中，我们关心的是一个样本的均值是否等于某个特定值。例如，在“在penguin数据中，全体被试的核心体温(Temperature)是否等于36.6？”这个例子中，我们关心的是全体被试的核心温度是否等于正常人的温度。单样本<em>t</em>检验的计算公式可以不用深究，关键是理解其背后的逻辑。</p>
<p><span class="math display">\[t = \frac{\bar{X} - \mu}{s / \sqrt{n}}\]</span></p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \epsilon\]</span></p>
<p>单样本<em>t</em>检验中，仅截距不为0。此时公式为：</p>
<p><span class="math display">\[y = \beta_0\]</span>
<span class="math display">\[H_0: \beta_0 = 0\]</span>
如图所示，这里有一群点，我们想要比较的是这些点的均值（例如用菱形表示）与某条线（特定值）之间是否存在显著性差异，或者说这些点的均值与这条线是否来自同一个总体。在这种情况下，我们可以构建一个只包含截距项β0的回归模型，即y = β0。我们也可以使用回归模型进行统计检验。</p>
<p><img src="pic/chp8/singlet-lm.png" width="75%"></p>
<p>当我们进行单样本<em>t</em>检验时，我们需要稍微调整公式。我们将因变量（temperature）减去我们想要比较的特定值（例如30），然后考虑减去特定值后的因变量均值是否属于一个以0为均值的正态分布。在这个回归模型中，我们加入一个截距项，用于进行<em>t</em>检验。</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="第八讲回归模型一.html#cb288-1" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">t.test</span>(</span>
<span id="cb288-2"><a href="第八讲回归模型一.html#cb288-2" tabindex="-1"></a>  <span class="at">x =</span> df.penguin<span class="sc">$</span>Temperature, <span class="co"># 核心体温均值</span></span>
<span id="cb288-3"><a href="第八讲回归模型一.html#cb288-3" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fl">36.6</span>) </span></code></pre></div>
<p><img src="pic/chp8/compare2.1.png" width="100%"></p>
<p>当然，在实际应用中，我们可以直接使用单样本<em>t</em>检验，将观测值x与某个特定值进行比较。这样，我们就可以判断样本数据的均值是否与特定值之间存在显著性差异，从而得出结论。总之，无论是单样本<em>t</em>检验还是回归模型，它们都可以帮助我们解决实际问题。在具体分析过程中，我们可以根据需要选择合适的方法。</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="第八讲回归模型一.html#cb289-1" tabindex="-1"></a>model.single <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb289-2"><a href="第八讲回归模型一.html#cb289-2" tabindex="-1"></a>  <span class="at">data =</span> df.penguin,</span>
<span id="cb289-3"><a href="第八讲回归模型一.html#cb289-3" tabindex="-1"></a>  <span class="at">formula =</span> Temperature <span class="sc">-</span> <span class="fl">36.6</span> <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb289-4"><a href="第八讲回归模型一.html#cb289-4" tabindex="-1"></a>  ) </span>
<span id="cb289-5"><a href="第八讲回归模型一.html#cb289-5" tabindex="-1"></a><span class="fu">summary</span>(model.single) </span></code></pre></div>
<p><img src="pic/chp8/compare2.2.png" width="100%"></p>
</div>
<div id="配对样本t检验paired-t-test" class="section level3 hasAnchor" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> 配对样本<em>t</em>检验(paired <em>t</em>-test)<a href="第八讲回归模型一.html#配对样本t检验paired-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>那么，对于配对样本<em>t</em>检验，我们其实可以把它看作是单样本<em>t</em>检验。因为配对样本<em>t</em>检验中的数据是一一对应的，我们可以通过一个简单的操作，即将两列配对数据相减，得到一列新的数据。然后，我们可以将这列新数据进行单样本<em>t</em>检验。</p>
<p><span class="math display">\[t = \frac{\bar{X} - \mu}{s / \sqrt{n}}\]</span>
这里的前提条件我们就不详细讲了。简单来说，对于配对样本<em>t</em>检验，我们可以先将两个值相减，得到他们的差值。然后，我们检验这个差值是否显著地不同于零。如果差值的分布明显不同于零，那么我们就可以认为两者之间存在显著的差异。
<span class="math display">\[y_1 - y_2 = \beta_0 \]</span>
<span class="math display">\[H_0: \beta_0 = 0 \]</span>
我们之所以能这样做，是因为在配对样本<em>t</em>检验中，每个被试都有两个数据点，这两个数据点是一一对应的。但是，对于独立样本<em>t</em>检验，由于数据点之间没有形成配对关系，我们不能直接相减。</p>
<p><img src="pic/chp8/pairt-lm.png" width="70%"></p>
<p>同样，对于配对样本<em>t</em>检验，我们也可以使用回归方法进行检验。方法类似于独立样本<em>t</em>检验，我们只需将两个值相减，然后检验这个差值的均值是否等于零。在R语言中，我们可以使用<code>t.test()</code>函数来进行配对样本<em>t</em>检验。我们只需将两列数据分别作为x和y输入，然后设置参数paired为TRUE，表示这两列数据是配对的，就可以进行配对样本<em>t</em>检验了。</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="第八讲回归模型一.html#cb290-1" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">t.test</span>(</span>
<span id="cb290-2"><a href="第八讲回归模型一.html#cb290-2" tabindex="-1"></a>  <span class="at">x =</span> df.penguin<span class="sc">$</span>Temperature_t1, </span>
<span id="cb290-3"><a href="第八讲回归模型一.html#cb290-3" tabindex="-1"></a>  <span class="at">y =</span> df.penguin<span class="sc">$</span>Temperature_t2, </span>
<span id="cb290-4"><a href="第八讲回归模型一.html#cb290-4" tabindex="-1"></a>  <span class="at">paired =</span> <span class="cn">TRUE</span></span>
<span id="cb290-5"><a href="第八讲回归模型一.html#cb290-5" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="pic/chp8/compare3.1.png" width="100%"></p>
<p>在前面我们讲了关于亲密关系和非亲密关系的两组人在体温上是否有区别的问题。我们可以使用配对样本<em>t</em>检验来进行检验，而配对样本<em>t</em>检验实际上是一个特殊的回归模型。同样地，对于所有其他类型的<em>t</em>检验，它们也都可以看作是特定的回归模型。因此，<em>t</em>检验与线性模型的本质是相同的。</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="第八讲回归模型一.html#cb291-1" tabindex="-1"></a>model.paired <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb291-2"><a href="第八讲回归模型一.html#cb291-2" tabindex="-1"></a>  Temperature_t1 <span class="sc">-</span> Temperature_t2 <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb291-3"><a href="第八讲回归模型一.html#cb291-3" tabindex="-1"></a>  <span class="at">data =</span> df.penguin</span>
<span id="cb291-4"><a href="第八讲回归模型一.html#cb291-4" tabindex="-1"></a>  )</span>
<span id="cb291-5"><a href="第八讲回归模型一.html#cb291-5" tabindex="-1"></a><span class="fu">summary</span>(model.paired)</span></code></pre></div>
<p><img src="pic/chp8/compare3.2.png" width="100%"></p>
</div>
<div id="brucerttest" class="section level3 hasAnchor" number="8.2.5">
<h3><span class="header-section-number">8.2.5</span> <code>bruceR::TTEST()</code><a href="第八讲回归模型一.html#brucerttest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>这里，我们可以介绍一下<code>bruceR</code>包中的<em>t</em>检验功能，它涵盖了我们前面提到的各种<em>t</em>检验，并且输出结果非常方便。如果大家下载了我们的课件，可以看到关于<code>bruceR</code>包中<em>t</em>检验各种参数的介绍。<code>bruceR</code>包基本上涵盖了所有类型的<em>t</em>检验，包括独立样本<em>t</em>检验、配对样本<em>t</em>检验和单样本<em>t</em>检验。它的输出结果通常是一个三线表，方便大家查看和理解。</p>
<p><img src="pic/chp8/TTEST.png" width="70%"></p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="第八讲回归模型一.html#cb292-1" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">t.test</span>(</span>
<span id="cb292-2"><a href="第八讲回归模型一.html#cb292-2" tabindex="-1"></a>  <span class="at">data =</span> df.penguin, </span>
<span id="cb292-3"><a href="第八讲回归模型一.html#cb292-3" tabindex="-1"></a>  Temperature <span class="sc">~</span> romantic,</span>
<span id="cb292-4"><a href="第八讲回归模型一.html#cb292-4" tabindex="-1"></a>  <span class="at">var.equal =</span> <span class="cn">TRUE</span></span>
<span id="cb292-5"><a href="第八讲回归模型一.html#cb292-5" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="pic/chp8/compare1.1.png" width="100%"></p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="第八讲回归模型一.html#cb293-1" tabindex="-1"></a>bruceR<span class="sc">::</span><span class="fu">TTEST</span>(</span>
<span id="cb293-2"><a href="第八讲回归模型一.html#cb293-2" tabindex="-1"></a>  <span class="at">data =</span> df.penguin, <span class="co"># 数据</span></span>
<span id="cb293-3"><a href="第八讲回归模型一.html#cb293-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">&quot;Temperature&quot;</span>, <span class="co"># 因变量</span></span>
<span id="cb293-4"><a href="第八讲回归模型一.html#cb293-4" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">&quot;romantic&quot;</span>     <span class="co"># 自变量</span></span>
<span id="cb293-5"><a href="第八讲回归模型一.html#cb293-5" tabindex="-1"></a>) </span></code></pre></div>
<p><img src="pic/chp8/leven.png" width="100%"></p>
<p>[单样本<em>t</em>检验]</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="第八讲回归模型一.html#cb294-1" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">t.test</span>(</span>
<span id="cb294-2"><a href="第八讲回归模型一.html#cb294-2" tabindex="-1"></a>  <span class="at">x =</span> df.penguin<span class="sc">$</span>Temperature, </span>
<span id="cb294-3"><a href="第八讲回归模型一.html#cb294-3" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fl">36.6</span></span>
<span id="cb294-4"><a href="第八讲回归模型一.html#cb294-4" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="pic/chp8/compare2.1.png" width="100%"></p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="第八讲回归模型一.html#cb295-1" tabindex="-1"></a>bruceR<span class="sc">::</span><span class="fu">TTEST</span>(</span>
<span id="cb295-2"><a href="第八讲回归模型一.html#cb295-2" tabindex="-1"></a>  <span class="at">data =</span> df.penguin, <span class="co"># 数据</span></span>
<span id="cb295-3"><a href="第八讲回归模型一.html#cb295-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">&quot;Temperature&quot;</span>, <span class="co"># 确定变量</span></span>
<span id="cb295-4"><a href="第八讲回归模型一.html#cb295-4" tabindex="-1"></a>  <span class="at">test.value =</span> <span class="fl">36.6</span>, <span class="co"># 固定值</span></span>
<span id="cb295-5"><a href="第八讲回归模型一.html#cb295-5" tabindex="-1"></a>  <span class="at">test.sided =</span> <span class="st">&quot;=&quot;</span>)  <span class="co"># 假设的方向</span></span></code></pre></div>
<p><img src="pic/chp8/sample.png" width="100%"></p>
<p>[配对样本<em>t</em>检验]</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="第八讲回归模型一.html#cb296-1" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">t.test</span>(</span>
<span id="cb296-2"><a href="第八讲回归模型一.html#cb296-2" tabindex="-1"></a>  <span class="at">x =</span> df.penguin<span class="sc">$</span>Temperature_t1, <span class="co">#第1次</span></span>
<span id="cb296-3"><a href="第八讲回归模型一.html#cb296-3" tabindex="-1"></a>  <span class="at">y =</span> df.penguin<span class="sc">$</span>Temperature_t2, <span class="co">#第2次</span></span>
<span id="cb296-4"><a href="第八讲回归模型一.html#cb296-4" tabindex="-1"></a>  <span class="at">paired =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<p><img src="pic/chp8/compare3.1.png" width="100%"></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="第八讲回归模型一.html#cb297-1" tabindex="-1"></a>bruceR<span class="sc">::</span><span class="fu">TTEST</span>(</span>
<span id="cb297-2"><a href="第八讲回归模型一.html#cb297-2" tabindex="-1"></a>  <span class="at">data =</span> df.penguin, <span class="co"># 数据</span></span>
<span id="cb297-3"><a href="第八讲回归模型一.html#cb297-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;Temperature_t1&quot;</span>,  </span>
<span id="cb297-4"><a href="第八讲回归模型一.html#cb297-4" tabindex="-1"></a>        <span class="st">&quot;Temperature_t2&quot;</span>), <span class="co"># 变量为两次核心体温</span></span>
<span id="cb297-5"><a href="第八讲回归模型一.html#cb297-5" tabindex="-1"></a>  <span class="at">paired =</span> T)  <span class="co"># 配对数据，默认是FALSE</span></span></code></pre></div>
<p><img src="pic/chp8/pair.png" width="100%"></p>
<p>无论是使用bruceR包中的<em>t</em>检验功能，还是R语言自带的<em>t</em>检验功能，我们都可以发现它们得到的结果与线性回归模型的结果是一模一样的。这再次证实了<em>t</em>检验与线性回归模型之间的密切关系。在实际研究中，我们可以根据问题的具体情况选择合适的方法，无论是<em>t</em>检验还是线性回归模型。同时，理解它们之间的关系有助于我们更好地掌握统计分析的原理和技巧。</p>
</div>
<div id="总结" class="section level3 hasAnchor" number="8.2.6">
<h3><span class="header-section-number">8.2.6</span> 总结<a href="第八讲回归模型一.html#总结" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>我们来做一个简单的总结。对于<em>t</em>检验，我们可以使用R自带的<code>t.test</code>函数。虽然语法上略有不同，但实际上，线性模型和<em>t</em>检验在本质上是一致的。单样本<em>t</em>检验可以看作是一个仅有截距的线性模型；独立样本<em>t</em>检验是一个仅有截距和一个斜率的线性模型；而配对样本<em>t</em>检验则是一个基于差值的仅有截距的线性模型。</p>
<p>独立样本<em>t</em>检验也可以看作是一个自变量为二分变量的线性回归模型。要理解为什么仅有截距的回归模型与<em>t</em>检验相关，我们可能需要回顾正态分布、抽样分布等概念，以及为什么我们使用t值这个分布来进行检验。然而，我们在这里没有足够的时间来展开这个话题。如果大家对此感兴趣，可以自行深入学习，也很推荐大家关注包寒吴霜老师的专栏。</p>
</div>
</div>
<div id="anova-linear-regression" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> ANOVA &amp; linear regression<a href="第八讲回归模型一.html#anova-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>接下来我们讨论方差分析，这也是心理学中常用的一种统计方法。在学习统计时，我们会花很多时间学习如何进行方差分解。</p>
<div id="研究问题-1" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> 研究问题<a href="第八讲回归模型一.html#研究问题-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>以Penguin数据为例，我们刚才发现恋爱状态对体温没有太大影响。但我们可以进一步探讨它是否与距离赤道的距离有交互作用。因为我们知道，离赤道越远，气温就越寒冷。有时候，我们可能会发现某个自变量没有影响，但实际上它可能受到另一个自变量的调节。例如，在这个例子中，我们可以检验恋爱状态是否在较寒冷的地方影响体温，而在较暖和的地方则不需要调节。要检验这种交互作用，我们通常会想到使用双因素方差分析。</p>
</div>
<div id="代码实操-知识回顾" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> 代码实操 &amp; 知识回顾<a href="第八讲回归模型一.html#代码实操-知识回顾" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>双因素方差分析通常是我们在讨论方差分析时所指的完全随机方差分析。但在这里，我们需要注意我们使用的是双因素的重复测量方差分析，而不是完全随机的。也就是说，不同距离赤道的人以及处于不同恋爱状态的人并非随机分配。我们无法将某人随机分配到离赤道较近的恋爱状态这一组，因为这是一个横断数据。然而，我们仍然可以使用方差分析来进行数据分析。</p>
<p>在学习方差分析时，我们可能会了解到它的历史以及它所检验的假设。对我们来说，检验的假设是关键。也就是说，在各因素的各个水平下，因变量的均值是否完全相同。原假设认为各因素各水平下的因变量均值完全相同，而备择假设则认为各因素各水平下的因变量均值并不完全相同。通常情况下，只要有一个水平的因变量均值不同，方差分析就能探测出来。</p>
<p>当然，方差分析的使用也有一些前提假设，包括随机性、正态性、独立性和方差齐性等。这些内容我们在这里就不再详细展开了。</p>
</div>
<div id="anova代码实操数据预处理" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> ANOVA代码实操|数据预处理<a href="第八讲回归模型一.html#anova代码实操数据预处理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R中实现方差分析的关键是选择合适的函数。当我们想进行多因素方差分析时，R中有一些常用的函数可以帮助我们实现。在进行方差分析之前，我们需要对数据进行一些预处理。</p>
<p>以距离赤道的距离为例，我们发现它是一个连续的数值变量。但为了进行方差分析，我们可以将其分为三个水平：热带、温带和寒温带。我们可以根据纬度的区别设定分隔点，例如，赤道到23.5度为热带，35度到40度为暖温带，40度到50度为中温带（统称为温带），50度以上为寒温带。我们可以使用R中的cut函数将连续性的数据划分为不同的段，并赋予不同的值。同时，我们可以为这个新变量命名为climate。
[vars]</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="第八讲回归模型一.html#cb298-1" tabindex="-1"></a><span class="fu">summary</span>(df.penguin<span class="sc">$</span>DEQ)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.29   34.43   39.91   39.84   51.32   60.39</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="第八讲回归模型一.html#cb300-1" tabindex="-1"></a><span class="co"># 设定分割点</span></span>
<span id="cb300-2"><a href="第八讲回归模型一.html#cb300-2" tabindex="-1"></a><span class="co"># [0-23.5 热带， 23.5-35 亚热带]， [35-40 暖温带， 40-50 中温带]， [50-66.5 寒温带]</span></span>
<span id="cb300-3"><a href="第八讲回归模型一.html#cb300-3" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">35</span>, <span class="dv">50</span>, <span class="fl">66.5</span>)</span>
<span id="cb300-4"><a href="第八讲回归模型一.html#cb300-4" tabindex="-1"></a></span>
<span id="cb300-5"><a href="第八讲回归模型一.html#cb300-5" tabindex="-1"></a><span class="co"># 设定相应的标签</span></span>
<span id="cb300-6"><a href="第八讲回归模型一.html#cb300-6" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;热带&#39;</span>, <span class="st">&#39;温带&#39;</span>, <span class="st">&#39;寒温带&#39;</span>)</span>
<span id="cb300-7"><a href="第八讲回归模型一.html#cb300-7" tabindex="-1"></a></span>
<span id="cb300-8"><a href="第八讲回归模型一.html#cb300-8" tabindex="-1"></a><span class="co"># 创建新的变量</span></span>
<span id="cb300-9"><a href="第八讲回归模型一.html#cb300-9" tabindex="-1"></a>df.penguin<span class="sc">$</span>climate <span class="ot">&lt;-</span> <span class="fu">cut</span>(df.penguin<span class="sc">$</span>DEQ, </span>
<span id="cb300-10"><a href="第八讲回归模型一.html#cb300-10" tabindex="-1"></a>                          <span class="at">breaks =</span> breaks, </span>
<span id="cb300-11"><a href="第八讲回归模型一.html#cb300-11" tabindex="-1"></a>                          <span class="at">labels =</span> labels)</span>
<span id="cb300-12"><a href="第八讲回归模型一.html#cb300-12" tabindex="-1"></a><span class="fu">summary</span>(df.penguin<span class="sc">$</span>climate)</span></code></pre></div>
<pre><code>##   热带   温带 寒温带 
##    396    592    439</code></pre>
<p>[tidy data]</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="第八讲回归模型一.html#cb302-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> df.penguin <span class="sc">%&gt;%</span> </span>
<span id="cb302-2"><a href="第八讲回归模型一.html#cb302-2" tabindex="-1"></a>  <span class="fu">select</span>(subjID, climate, romantic, Temperature) </span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-b3d6b124030db52fd062" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b3d6b124030db52fd062">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6"],[1,2,3,4,5,6],["热带","寒温带","寒温带","寒温带","温带","寒温带"],["单身","恋爱","恋爱","恋爱","恋爱","恋爱"],[36.75,35.40000000000001,35.1,35.95,36.08333333,35.59999999999999]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>subjID<\/th>\n      <th>climate<\/th>\n      <th>romantic<\/th>\n      <th>Temperature<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"subjID","targets":1},{"name":"climate","targets":2},{"name":"romantic","targets":3},{"name":"Temperature","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="代码实操正态性检验" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> 代码实操|正态性检验<a href="第八讲回归模型一.html#代码实操正态性检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在进行方差分析前，我们还需要检验数据的正态性。R中有一些方法可以帮助我们检验正态性，例如KS检验和QQ图。通过这些方法，我们可以观察数据的分布情况。虽然数据可能不是完全正态分布的，但接近正态分布的数据也是可以接受的。</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="第八讲回归模型一.html#cb303-1" tabindex="-1"></a><span class="co"># 正态性检验-Kolmogorov-Smirnov检验</span></span>
<span id="cb303-2"><a href="第八讲回归模型一.html#cb303-2" tabindex="-1"></a><span class="co"># 若p &gt;.05，不能拒绝数据符合正态分布的零假设</span></span>
<span id="cb303-3"><a href="第八讲回归模型一.html#cb303-3" tabindex="-1"></a><span class="fu">ks.test</span>(df<span class="sc">$</span>Temperature, <span class="st">&#39;pnorm&#39;</span>)</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  df$Temperature
## D = 1, p-value &lt;0.0000000000000002
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="第八讲回归模型一.html#cb305-1" tabindex="-1"></a><span class="co"># 进行数据转换，转换后仍非正态分布</span></span>
<span id="cb305-2"><a href="第八讲回归模型一.html#cb305-2" tabindex="-1"></a>df<span class="sc">$</span>Temperature_log <span class="ot">&lt;-</span> <span class="fu">log</span>(df<span class="sc">$</span>Temperature)</span>
<span id="cb305-3"><a href="第八讲回归模型一.html#cb305-3" tabindex="-1"></a><span class="fu">ks.test</span>(df<span class="sc">$</span>Temperature_log, <span class="st">&#39;pnorm&#39;</span>)</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  df$Temperature_log
## D = 1, p-value &lt;0.0000000000000002
## alternative hypothesis: two-sided</code></pre>
<p>[qq图]</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="第八讲回归模型一.html#cb307-1" tabindex="-1"></a><span class="co"># 正态性检验-qq图</span></span>
<span id="cb307-2"><a href="第八讲回归模型一.html#cb307-2" tabindex="-1"></a><span class="fu">qqnorm</span>(df<span class="sc">$</span>Temperature)</span>
<span id="cb307-3"><a href="第八讲回归模型一.html#cb307-3" tabindex="-1"></a><span class="fu">qqline</span>(df<span class="sc">$</span>Temperature, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="co"># 添加理论正态分布线</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-156-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><a href="第七讲描述性统计与数据可视化基础.html#直方图">直方图</a></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="第八讲回归模型一.html#cb308-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(Temperature)) <span class="sc">+</span></span>
<span id="cb308-2"><a href="第八讲回归模型一.html#cb308-2" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span>..density..), <span class="at">color=</span><span class="st">&#39;black&#39;</span>, <span class="at">fill=</span><span class="st">&#39;white&#39;</span>, <span class="at">bins=</span><span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb308-3"><a href="第八讲回归模型一.html#cb308-3" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">fill=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-157-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="代码实操双因素被试间方差分析" class="section level3 hasAnchor" number="8.3.5">
<h3><span class="header-section-number">8.3.5</span> 代码实操|双因素被试间方差分析<a href="第八讲回归模型一.html#代码实操双因素被试间方差分析" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R中实现方差分析，我们通常会用到<code>aov()</code>函数，这是R自带的一个函数。实际上，这个函数来自于stats包，同样的，<code>t.test()</code>函数和<code>lm()</code>函数也是来源于这个包。在进行方差分析时，我们采用的语法与<em>t</em>检验非常相似，仍然是线性回归的写法。我们将因变量放在前面，自变量放在后面，中间用一个波浪号连接。然后，我们指定使用的数据。</p>
<p>在方差分析的语法中，我们使用乘号 * 来表示主效应及其交互作用。例如，我们可以写成climate * romantic，这表示考虑climate和romantic的主效应以及它们之间的交互作用。在R中，这样的写法非常常见，前面的波浪号表示因变量与自变量之间的关系，而乘号表示考虑主效应及交互作用。</p>
<p>实际上，这种线性方程有多种写法。例如，在<em>t</em>检验中，我们只关注romantic；而在方差分析中，我们加入了climate的主效应以及它们之间的交互作用。在R中最基础的包里，当我们进行方差分析时，实际上沿用了线性模型的语法。通过这种语法，我们可以得到方差分析的一些统计值，如F值、P值以及我们熟悉的平方和（SS，Sum of Squares）。</p>
<p>如果我们对方差分析的结果使用summary函数进行查看，我们会看到熟悉的方差分析表。在这个表中，我们可以看到两个主效应（romantic和climate）以及它们之间的交互作用。同时，表格中还包含了残差（Residuals）信息。这些信息有助于我们了解各个因素对因变量的影响程度和显著性。</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="第八讲回归模型一.html#cb309-1" tabindex="-1"></a>aov1 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">aov</span>(Temperature <span class="sc">~</span> climate <span class="sc">*</span> romantic, <span class="at">data =</span> df)</span>
<span id="cb309-2"><a href="第八讲回归模型一.html#cb309-2" tabindex="-1"></a><span class="fu">summary</span>(aov1)</span></code></pre></div>
<pre><code>##                    Df Sum Sq Mean Sq F value              Pr(&gt;F)    
## climate             2   18.8    9.41   49.39 &lt;0.0000000000000002 ***
## romantic            1    0.2    0.24    1.28              0.2581    
## climate:romantic    2    1.9    0.95    5.01              0.0068 ** 
## Residuals        1421  270.7    0.19                                
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>在进行方差分析时，有时我们会发现，在R中进行的分析结果与在SPSS中进行的结果不完全一样。例如，climate的F值在R中为49.39，而在SPSS中为50.88。这种情况下，我们可能会感到困惑，不知道是否可以信任R的结果，甚至可能会认为R的分析方法不靠谱。</p>
<p>[SPSS]
<img src="pic/chp8/SPSS.png" width="610" style="display: block; margin: auto;" />
实际上，这种差异的出现很可能是因为在R和SPSS中使用的方法或某些设置不同。这可能导致在相同的数据和看似相同的方法下，得到不同的分析结果。在这里，我们需要讨论一个问题：为什么方差分析这样一个看似简单的方法（我们在本科阶段就学过并且很熟悉），会在不同软件中产生不同的结果呢？</p>
</div>
<div id="代码实操平方和ss的计算" class="section level3 hasAnchor" number="8.3.6">
<h3><span class="header-section-number">8.3.6</span> 代码实操|平方和(SS)的计算<a href="第八讲回归模型一.html#代码实操平方和ss的计算" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在进行方差分析时，可能会涉及到平方和计算方法的问题。在平衡设计下，即每个条件下的样本量相同时，三类平方和的结果是没有差别的。但在不平衡设计下，即每个条件下的样本量不同时，就需要进行一些调整。</p>
<p>这里的不平衡设计是指，比如我们有两个变量，climate有三个水平，romantic有两个水平，那么组合之后就有六个条件，但这六个条件下的被试数量可能是不同的。理论上，最好的情况是每个条件下的被试数量是一样的，这样的设计被称为平衡设计。在平衡设计中，三种类型的平方和的结果会很清晰，并且方差分析的结果独立于平方和的类型。但在实际情况中，这种设计可能较难实现，从而导致不平衡设计。</p>
<p>在不平衡设计下，计算方差时就会出现问题，因为我们需要将不同组的方差进行合并。尤其是当各组样本量差距较大时，三种类型的平方和计算结果可能会不同。在这种情况下，我们需要进行一些调整，需要根据具体研究设计和问题来选择使用哪一种类型的平方和。这就产生了三类平方和。SPSS默认使用的是第三类平方和，而在R中，aov函数默认使用的是第一类平方和。因此，当我们使用R进行方差分析时，可能会发现结果与SPSS有所不同。</p>
<p>这种情况下，我们需要更深入地理解平方和的计算方法，以便正确解读R的输出结果。这也是我们在使用R进行统计分析时，需要不断强化统计知识的一个重要原因。因为相比于SPSS这类点击式操作的软件，R提供了更多的选项，而正确理解和使用这些选项，就需要我们对统计学有更深入的理解。</p>
<p>[car::Anova()]</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="第八讲回归模型一.html#cb311-1" tabindex="-1"></a><span class="co"># 结果不一致，原因PPT显示不全，请回到rmd文档查看</span></span>
<span id="cb311-2"><a href="第八讲回归模型一.html#cb311-2" tabindex="-1"></a>aov1 <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Anova</span>(stats<span class="sc">::</span><span class="fu">aov</span>(Temperature <span class="sc">~</span> climate <span class="sc">*</span> romantic, <span class="at">data =</span> df))</span>
<span id="cb311-3"><a href="第八讲回归模型一.html#cb311-3" tabindex="-1"></a>aov1</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: Temperature
##                  Sum Sq   Df F value              Pr(&gt;F)    
## climate            19.0    2   49.97 &lt;0.0000000000000002 ***
## romantic            0.2    1    1.28              0.2581    
## climate:romantic    1.9    2    5.01              0.0068 ** 
## Residuals         270.7 1421                                
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>我们是否能得到完全相同的结果呢？实际上，这是完全可能的。例如，我们可以使用afex这个包，这是在2017或2018年后出现的一个包。afex是为了满足实验心理学家进行方差分析的需求而设计的，其中包含了各种方差分析的功能。如果我们按照这样的写法，即将被试的identity写在这里，然后将类型设置为三，我们就能得到完全相同的结果。我们也可以在其他地方使用同样的方法，同样能得到一模一样的结果。</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="第八讲回归模型一.html#cb313-1" tabindex="-1"></a><span class="co"># 原因debug</span></span>
<span id="cb313-2"><a href="第八讲回归模型一.html#cb313-2" tabindex="-1"></a><span class="co"># 查看R的默认对比设置</span></span>
<span id="cb313-3"><a href="第八讲回归模型一.html#cb313-3" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;contrasts&quot;</span>)</span></code></pre></div>
<pre><code>## $contrasts
##         unordered           ordered 
## &quot;contr.treatment&quot;      &quot;contr.poly&quot;</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="第八讲回归模型一.html#cb315-1" tabindex="-1"></a><span class="co"># 从输出结果可知，无序默认为contr.treatment()，有序默认为contr.poly()</span></span>
<span id="cb315-2"><a href="第八讲回归模型一.html#cb315-2" tabindex="-1"></a><span class="co"># factor()函数来创建无序因子，ordered()函数创建有序因子</span></span>
<span id="cb315-3"><a href="第八讲回归模型一.html#cb315-3" tabindex="-1"></a></span>
<span id="cb315-4"><a href="第八讲回归模型一.html#cb315-4" tabindex="-1"></a><span class="fu">is.factor</span>(df<span class="sc">$</span>climate)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="第八讲回归模型一.html#cb317-1" tabindex="-1"></a><span class="fu">is.ordered</span>(df<span class="sc">$</span>climate)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="第八讲回归模型一.html#cb319-1" tabindex="-1"></a><span class="co"># climate是无序因子</span></span>
<span id="cb319-2"><a href="第八讲回归模型一.html#cb319-2" tabindex="-1"></a></span>
<span id="cb319-3"><a href="第八讲回归模型一.html#cb319-3" tabindex="-1"></a><span class="co"># 创建一个3水平的因子的基准对比</span></span>
<span id="cb319-4"><a href="第八讲回归模型一.html#cb319-4" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb319-5"><a href="第八讲回归模型一.html#cb319-5" tabindex="-1"></a></span>
<span id="cb319-6"><a href="第八讲回归模型一.html#cb319-6" tabindex="-1"></a><span class="co"># 创建一个新的对比，这个编码假设分类水平之间的差异被等分，每一个水平与总均值的差异等于1/3</span></span>
<span id="cb319-7"><a href="第八讲回归模型一.html#cb319-7" tabindex="-1"></a>my.coding <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">6</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb319-8"><a href="第八讲回归模型一.html#cb319-8" tabindex="-1"></a><span class="co"># 将对比调整为每个水平与第一个水平的振幅减去1/3</span></span>
<span id="cb319-9"><a href="第八讲回归模型一.html#cb319-9" tabindex="-1"></a><span class="co"># 可能的原因：除了关心每个水平对应的效果，同时也关心水平与水平之间的效果</span></span>
<span id="cb319-10"><a href="第八讲回归模型一.html#cb319-10" tabindex="-1"></a>my.simple <span class="ot">&lt;-</span> c1<span class="sc">-</span>my.coding</span>
<span id="cb319-11"><a href="第八讲回归模型一.html#cb319-11" tabindex="-1"></a>my.simple</span></code></pre></div>
<pre><code>##          2        3
## 1 -0.33333 -0.33333
## 2  0.66667 -0.33333
## 3 -0.33333  0.66667</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="第八讲回归模型一.html#cb321-1" tabindex="-1"></a><span class="co"># 更改climate的对比</span></span>
<span id="cb321-2"><a href="第八讲回归模型一.html#cb321-2" tabindex="-1"></a><span class="fu">contrasts</span>(df<span class="sc">$</span>climate) <span class="ot">&lt;-</span> my.simple</span>
<span id="cb321-3"><a href="第八讲回归模型一.html#cb321-3" tabindex="-1"></a></span>
<span id="cb321-4"><a href="第八讲回归模型一.html#cb321-4" tabindex="-1"></a><span class="co"># 将数据集df的romantic列的对比设为等距对比，它假设分类水平之间的差异为等距离</span></span>
<span id="cb321-5"><a href="第八讲回归模型一.html#cb321-5" tabindex="-1"></a><span class="fu">contrasts</span>(df<span class="sc">$</span>romantic) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb321-6"><a href="第八讲回归模型一.html#cb321-6" tabindex="-1"></a></span>
<span id="cb321-7"><a href="第八讲回归模型一.html#cb321-7" tabindex="-1"></a><span class="co"># 方差分析</span></span>
<span id="cb321-8"><a href="第八讲回归模型一.html#cb321-8" tabindex="-1"></a>aov1 <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Anova</span>(<span class="fu">lm</span>(Temperature <span class="sc">~</span> climate <span class="sc">*</span> romantic, <span class="at">data =</span> df),</span>
<span id="cb321-9"><a href="第八讲回归模型一.html#cb321-9" tabindex="-1"></a>                   <span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb321-10"><a href="第八讲回归模型一.html#cb321-10" tabindex="-1"></a>aov1</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: Temperature
##                   Sum Sq   Df    F value              Pr(&gt;F)    
## (Intercept)      1768309    1 9284069.65 &lt;0.0000000000000002 ***
## climate               19    2      50.88 &lt;0.0000000000000002 ***
## romantic               0    1       1.00              0.3173    
## climate:romantic       2    2       5.01              0.0068 ** 
## Residuals            271 1421                                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>[afex::aov_ez()]</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="第八讲回归模型一.html#cb323-1" tabindex="-1"></a>afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">&quot;subjID&quot;</span>, </span>
<span id="cb323-2"><a href="第八讲回归模型一.html#cb323-2" tabindex="-1"></a>             <span class="at">dv =</span> <span class="st">&quot;Temperature&quot;</span>, </span>
<span id="cb323-3"><a href="第八讲回归模型一.html#cb323-3" tabindex="-1"></a>             <span class="at">data =</span> df, </span>
<span id="cb323-4"><a href="第八讲回归模型一.html#cb323-4" tabindex="-1"></a>             <span class="at">between =</span> <span class="fu">c</span>(<span class="st">&quot;climate&quot;</span>, <span class="st">&quot;romantic&quot;</span>), </span>
<span id="cb323-5"><a href="第八讲回归模型一.html#cb323-5" tabindex="-1"></a>             <span class="at">type =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Contrasts set to contr.sum for the following variables: climate, romantic</code></pre>
<pre><code>## Anova Table (Type 3 tests)
## 
## Response: Temperature
##             Effect      df  MSE         F   ges p.value
## 1          climate 2, 1421 0.19 50.88 ***  .067   &lt;.001
## 2         romantic 1, 1421 0.19      1.00 &lt;.001    .317
## 3 climate:romantic 2, 1421 0.19   5.01 **  .007    .007
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="第八讲回归模型一.html#cb326-1" tabindex="-1"></a><span class="co"># afex中的其他函数可以得到同样的结果</span></span>
<span id="cb326-2"><a href="第八讲回归模型一.html#cb326-2" tabindex="-1"></a>afex<span class="sc">::</span><span class="fu">aov_car</span>(Temperature <span class="sc">~</span> climate <span class="sc">*</span> romantic <span class="sc">+</span> <span class="fu">Error</span>(subjID), <span class="at">data =</span> df, <span class="at">type =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Contrasts set to contr.sum for the following variables: climate, romantic</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="第八讲回归模型一.html#cb328-1" tabindex="-1"></a>afex<span class="sc">::</span><span class="fu">aov_4</span>(Temperature <span class="sc">~</span> climate <span class="sc">*</span> romantic <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subjID), <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## Contrasts set to contr.sum for the following variables: climate, romantic</code></pre>
<p>也就是说，如果我们使用最常见的R代码，很可能会得到与SPSS不同的结果。同样的现象也可能发生在我们习惯使用AMOS进行结构方程模型（SEM）的情况下。当你使用R的某些包进行结构方程模型时，即使是同样的数据和结构，可能会得到不同的结果。这可能是因为它们内部设定的不同。因此，我们需要去了解它们内部的设定是什么。</p>
</div>
</div>
<div id="线性回归" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> 线性回归<a href="第八讲回归模型一.html#线性回归" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>我们刚刚讨论的是<em>t</em>检验，它是一种特定的回归模型。而对于ANOVA（方差分析），从它的表示方法来看，我们可以很明显地看出它实际上也是一个回归模型。因为它的方程表示形式与线性模型非常相似，包括一些自变量以及它们之间是否存在交互作用。在实际应用中，我们经常会遇到单因素方差分析和多因素方差分析。</p>
<p>在这种情况下，两因素方差分析也是一个特殊的回归模型。它的特殊之处在于我们的自变量是分类变量，也可以称为离散变量。因此，在进行方差分析时，我们需要注意处理这些分类变量或离散变量。</p>
<p>假设我们这里有一个2×2的设计，也就是有四个条件，这四个条件可以视为四组。每一组被试在某一因变量上都会有自己的取值。我们需要检验的是这四组被试的均值是否完全相同，即它们是否有偏离总体均值的情况。这就是我们进行方差分析的一个核心目标。在线性模型上，我们也在检验同样的问题。</p>
<p>比如说，我们可以通过某种方式对自变量进行编码，然后观察各组的均值与其他组之间的差异是否达到显著水平。举个例子，这里我们展示的是一种非常简单的编码方式，我们以某一条件下的值作为零点，比如第一组，然后其他所有的系数都是其他组的均值与这个零点的差异，也就是我们斜率的比较对象。</p>
<p>可能这么说有点抽象，让我们以一个具体的例子来说明。假设我们有一个变量叫”romantic”，我们可以把它编码为0和1。同样地，我们也可以把其他变量编码为0和1。如果我们简化这两种情况，就更容易理解了。</p>
<p>在这里，我们可以看到如果有一个组合为0和0，那么在我们的回归模型中，这个部分就变成了β0。在这种编码方式下，β0代表的就是某个条件下的均值。通过这种方式，我们可以看到β1可能代表的是某种条件下的值，比如当某个变量取值为1或0时的情况。同样，β2可能代表的是另一个变量在取值为1、0或者两个变量都为1时的情况。</p>
<p>所有这些回归系数都可以被理解为组间的差异值。我们的回归模型的目标就是去检验这些差异是否显著。在做回归模型时，我们检验显著性的方式可能有所不同。在这种最简化的情况下，我们可以看到，我们的2×2的两因素方差分析完全可以对应成为一个离散变量的回归模型。</p>
<p><img src="pic/chp8/aovLM.png" width="662" style="display: block; margin: auto;" /></p>
<p>如果我们采用ANOVA或者线性模型，并且我们的设定是一样的，那么得到的结果将会是完全一样的。可能我讲得有点快，大家可能需要回顾一下自己学的线性回归的知识。因为我不确定其他的统计老师在讲线性回归的时候是否已经将其与ANOVA或<em>t</em>检验进行了关联。但大家可以这样理解，它们本质上都是一样的。如果大家理解了，ANOVA其实就是线性回归的一个特定模式，那么你们就已经把握了其要点。</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="第八讲回归模型一.html#cb330-1" tabindex="-1"></a>aov1 <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Anova</span>(<span class="fu">aov</span>(Temperature <span class="sc">~</span> climate <span class="sc">*</span> romantic, </span>
<span id="cb330-2"><a href="第八讲回归模型一.html#cb330-2" tabindex="-1"></a>                       <span class="at">data =</span> df), </span>
<span id="cb330-3"><a href="第八讲回归模型一.html#cb330-3" tabindex="-1"></a>                   <span class="at">type =</span> <span class="dv">3</span></span>
<span id="cb330-4"><a href="第八讲回归模型一.html#cb330-4" tabindex="-1"></a>                   )</span>
<span id="cb330-5"><a href="第八讲回归模型一.html#cb330-5" tabindex="-1"></a>aov1</span></code></pre></div>
<p><img src="pic/chp8/compare8231.png" /></p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="第八讲回归模型一.html#cb331-1" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Anova</span>(</span>
<span id="cb331-2"><a href="第八讲回归模型一.html#cb331-2" tabindex="-1"></a>  <span class="fu">lm</span>(Temperature <span class="sc">~</span> climate <span class="sc">*</span> romantic, </span>
<span id="cb331-3"><a href="第八讲回归模型一.html#cb331-3" tabindex="-1"></a>     <span class="at">data =</span> df), </span>
<span id="cb331-4"><a href="第八讲回归模型一.html#cb331-4" tabindex="-1"></a>  <span class="at">type =</span> <span class="dv">3</span></span>
<span id="cb331-5"><a href="第八讲回归模型一.html#cb331-5" tabindex="-1"></a>  )</span>
<span id="cb331-6"><a href="第八讲回归模型一.html#cb331-6" tabindex="-1"></a>lm1</span></code></pre></div>
<p><img src="pic/chp8/compare8232.png" /></p>
<p>在实际研究中，即使我们知道ANOVA与线性回归有相似之处，但我们仍然需要报告传统的方差分析结果。在这种情况下，我们推荐使用<code>bruceR</code>包的<code>MANOVA</code>函数，它是一个非常强大的函数，基本上涵盖了我们在心理学中常用的所有ANOVA类型。使用<code>MANOVA</code>函数可以大大简化心理学研究者使用这个方法的门槛。</p>
<p><img src="pic/chp8/ANOVA%20data.png" width="65%"></p>
<p>关于<code>MANOVA</code>函数的主要参数，我们不再详细讲解，大家可以查阅相关资料。该函数非常全面，而且有一个非常好的特点，就是它可以直接将结果保存为三线表格，方便我们将结果粘贴到Word文档中进行报告。</p>
<p><img src="pic/chp8/MANOVA.png" width="70%"></p>
<p>以我们刚才讲解的例子为例，我们要对climate和romantic进行方差分析，我们可以调用<code>MANOVA</code>函数，设置dependent variable为temperature，参数设为between表示主间变量。这里有两个主间变量。大家可以看到，得到的结果与SPSS是完全相同的，如50.88。</p>
<p>与SPSS不同之处在于<code>MANOVA</code>函数会输出Generalized Eta Squared（广义η²），这是方差分析的一个效应量指标，有助于我们更好地理解结果。关于效应量的指标，对于传统心理学来说，我们通常只关注p值。但实际上，最近的趋势是大家会更加关注效应量有多大，而不仅仅是p值是否显著。换句话说，我们不仅关心结果是否显著，还关心效应量是否足够大。</p>
<p>在方差分析中，我们经常会进行进一步的简单效应分析和事后多重比较。这里的操作比较灵活。例如，如果你使用的是纯粹的重复测量设计，那么在没有交互作用的情况下，我们可能会进行多重比较，也就是比较某一条件下不同水平之间是否存在差异。然而，如果存在交互作用，我们可能需要重新检查在某一自变量的水平下，另一个自变量是否具有效应。这种情况下，我们称之为简单效应。简单效应分析可以帮助我们深入了解在某一特定条件下，不同水平之间的差异，以便更好地解释和理解我们的研究结果。</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="第八讲回归模型一.html#cb332-1" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> bruceR<span class="sc">::</span><span class="fu">MANOVA</span>(<span class="at">data =</span> df, </span>
<span id="cb332-2"><a href="第八讲回归模型一.html#cb332-2" tabindex="-1"></a>                       <span class="at">dv =</span> <span class="st">&quot;Temperature&quot;</span>, </span>
<span id="cb332-3"><a href="第八讲回归模型一.html#cb332-3" tabindex="-1"></a>                       <span class="at">between =</span> <span class="fu">c</span>(<span class="st">&quot;climate&quot;</span>, <span class="st">&quot;romantic&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Anova Table (Type III tests)&quot;                                  
## [2] &quot;&quot;                                                              
## [3] &quot;Response: Temperature&quot;                                         
## [4] &quot;            Effect      df  MSE         F   ges p.value&quot;       
## [5] &quot;1          climate 2, 1421 0.19 50.88 ***  .067   &lt;.001&quot;       
## [6] &quot;2         romantic 1, 1421 0.19      1.00 &lt;.001    .317&quot;       
## [7] &quot;3 climate:romantic 2, 1421 0.19   5.01 **  .007    .007&quot;       
## [8] &quot;---&quot;                                                           
## [9] &quot;Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1&quot;</code></pre>
<p>在这个例子中，我们可以看到，我们对climate和romantic进行了方差分析，试图查看在不同的romantic条件下（即单身或非单身），climate是否有影响。这就是简单效应分析。</p>
<p>在R中，我们可以看到<code>MANOVA</code>函数的输出结果。首先，它会输出描述性统计结果，包括climate和romantic的各个水平的均值、标准差和样本量。然后，它会给出方差分析表，包括climate的主效应、romantic的主效应和它们的交互作用的效应。我们可以看到，climate的主效应是显著的，这与我们的预期一致。即在不同气候带的人们体温存在差异，其p值非常小，F值也比较大。此外，我们也发现climate和romantic的交互作用是显著的，这也与我们的预期相符。</p>
<p>原先，我们试图通过<em>t</em>检验来查看不同romantic状态下的人们体温是否有区别，但我们并没有发现显著差异。然后，我们怀疑这可能是因为人的体温受到climate的影响，这个效应可能掩盖了romantic的影响。因此，我们引入了climate这个因素，然后再次检验romantic和climate的交互作用。结果显示，这个交互作用是显著的，这也就验证了我们的猜想。</p>
<p>在<code>MANOVA</code>中，它会输出各种效应量指标，如η²和广义η²（Generalized Eta Squared）。通常情况下，在做方差分析时，我们会报告广义η²。实际上，关于方差分析的效应量指标是一个重要且不容易掌握的知识点。<code>MANOVA</code>，它还会输出其他效应量指标，如Cohen’s f和方差同质性检验结果。这些输出结果非常符合心理学研究者的使用习惯。</p>
<p><img src="pic/chp8/EMMEANS.png" width="70%"></p>
<p>当我们发现交互作用时，我们通常需要进一步了解这个交互作用代表什么。在这种情况下，我们可以使用<code>emmeans</code>（estimated marginal means）函数来查看不同条件下的结果。这个函数可以帮助我们查看在不同条件下，climate和romantic之间的简单效应。通过<code>emmeans</code>函数，我们可以得到一个三线表，展示了在不同romantic条件下，climate的简单效应。在这个表格中，我们可以看到，在不同的romantic条件下，climate都具有显著效应。这些信息有助于我们更深入地了解交互作用背后的实际情况。</p>
<p>在这个分析过程中，我们首先在恋爱和单身的条件下分别看了climate的影响，并发现climate在两种情况下都有显著影响，虽然效应量可能会有所不同。然后，我们进一步进行了事后(post-hoc)比较，比较了恋爱和单身状态下，不同climate的体温差异，结果显示基本上所有的差异都是显著的。</p>
<p>然后，我们通过改变分组条件，看了在不同climate下，恋爱关系是否有影响。结果显示，在热带和温带，恋爱关系没有显著影响，但在寒带，恋爱关系则有显著影响。这个结果与我们的预期相符，表明在较冷的气候下，恋爱关系对体温有调节作用。</p>
<p>此外，我们还进行了<em>F</em>检验，实际上是在热带、温带和寒带三种条件下进行了单因素方差分析。由于只有两个水平（恋爱和单身），所以这个<em>F</em>检验的结果与后面的<em>t</em>检验结果基本一致。这是因为在只有两个水平的情况下，<em>F</em>检验和<em>t</em>检验的结果是一样的。如果你对这个有兴趣，你可以进一步查看t值和F值之间的关系。</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="第八讲回归模型一.html#cb334-1" tabindex="-1"></a>sim_eff <span class="ot">&lt;-</span> res1 <span class="sc">%&gt;%</span> </span>
<span id="cb334-2"><a href="第八讲回归模型一.html#cb334-2" tabindex="-1"></a>  bruceR<span class="sc">::</span><span class="fu">EMMEANS</span>(<span class="st">&quot;climate&quot;</span>, <span class="at">by =</span> <span class="st">&quot;romantic&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb334-3"><a href="第八讲回归模型一.html#cb334-3" tabindex="-1"></a>  bruceR<span class="sc">::</span><span class="fu">EMMEANS</span>(<span class="st">&quot;romantic&quot;</span>, <span class="at">by =</span> <span class="st">&quot;climate&quot;</span>)</span></code></pre></div>
<p>—— EMMEANS (effect = “climate”) ——</p>
<p>Joint Tests of “climate”:
─────────────────────────────────────────────────────────────────
Effect “romantic” df1 df2 F p η²p [90% CI of η²p]
─────────────────────────────────────────────────────────────────
climate 恋爱 2 1421 13.165 &lt;.001 *** .018 [.008, .031]
climate 单身 2 1421 41.817 &lt;.001 *** .056 [.037, .075]
─────────────────────────────────────────────────────────────────
Note. Simple effects of repeated measures with 3 or more levels
are different from the results obtained with SPSS MANOVA syntax.</p>
<p>Estimated Marginal Means of “climate”:
─────────────────────────────────────────────────────
“climate” “romantic” Mean [95% CI of Mean] S.E.
─────────────────────────────────────────────────────
热带 恋爱 36.510 [36.446, 36.575] (0.033)
温带 恋爱 36.393 [36.346, 36.440] (0.024)
寒温带 恋爱 36.296 [36.245, 36.347] (0.026)
热带 单身 36.590 [36.532, 36.648] (0.029)
温带 单身 36.356 [36.303, 36.409] (0.027)
寒温带 单身 36.182 [36.114, 36.250] (0.035)
─────────────────────────────────────────────────────</p>
<p>Pairwise Comparisons of “climate”:
────────────────────────────────────────────────────────────────────────────────────────
Contrast “romantic” Estimate S.E. df t p Cohen’s d [95% CI of d]
────────────────────────────────────────────────────────────────────────────────────────
温带 - 热带 恋爱 -0.117 (0.041) 1421 -2.879 .012 * -0.268 [-0.491, -0.045]
寒温带 - 热带 恋爱 -0.214 (0.042) 1421 -5.111 &lt;.001 *** -0.490 [-0.720, -0.260]
寒温带 - 温带 恋爱 -0.097 (0.035) 1421 -2.741 .019 * -0.222 [-0.417, -0.028]
温带 - 热带 单身 -0.234 (0.040) 1421 -5.853 &lt;.001 *** -0.536 [-0.756, -0.317]
寒温带 - 热带 单身 -0.409 (0.046) 1421 -8.969 &lt;.001 *** -0.936 [-1.186, -0.686]
寒温带 - 温带 单身 -0.174 (0.044) 1421 -3.966 &lt;.001 *** -0.400 [-0.641, -0.158]
────────────────────────────────────────────────────────────────────────────────────────
Pooled SD for computing Cohen’s d: 0.436
P-value adjustment: Bonferroni method for 3 tests.</p>
<p>Disclaimer:
By default, pooled SD is Root Mean Square Error (RMSE).
There is much disagreement on how to compute Cohen’s d.
You are completely responsible for setting <code>sd.pooled</code>.
You might also use <code>effectsize::t_to_d()</code> to compute d.</p>
<p>—— EMMEANS (effect = “romantic”) ——</p>
<p>Joint Tests of “romantic”:
────────────────────────────────────────────────────────────────
Effect “climate” df1 df2 F p η²p [90% CI of η²p]
────────────────────────────────────────────────────────────────
romantic 热带 1 1421 3.287 .070 . .002 [.000, .008]
romantic 温带 1 1421 1.055 .305 .001 [.000, .005]
romantic 寒温带 1 1421 6.966 .008 ** .005 [.001, .013]
────────────────────────────────────────────────────────────────
Note. Simple effects of repeated measures with 3 or more levels
are different from the results obtained with SPSS MANOVA syntax.</p>
<p>Estimated Marginal Means of “romantic”:
─────────────────────────────────────────────────────
“romantic” “climate” Mean [95% CI of Mean] S.E.
─────────────────────────────────────────────────────
恋爱 热带 36.510 [36.446, 36.575] (0.033)
单身 热带 36.590 [36.532, 36.648] (0.029)
恋爱 温带 36.393 [36.346, 36.440] (0.024)
单身 温带 36.356 [36.303, 36.409] (0.027)
恋爱 寒温带 36.296 [36.245, 36.347] (0.026)
单身 寒温带 36.182 [36.114, 36.250] (0.035)
─────────────────────────────────────────────────────</p>
<p>Pairwise Comparisons of “romantic”:
─────────────────────────────────────────────────────────────────────────────────────
Contrast “climate” Estimate S.E. df t p Cohen’s d [95% CI of d]
─────────────────────────────────────────────────────────────────────────────────────
单身 - 恋爱 热带 0.080 (0.044) 1421 1.813 .070 . 0.183 [-0.015, 0.382]
单身 - 恋爱 温带 -0.037 (0.036) 1421 -1.027 .305 -0.085 [-0.247, 0.077]
单身 - 恋爱 寒温带 -0.115 (0.043) 1421 -2.639 .008 ** -0.262 [-0.458, -0.067]
─────────────────────────────────────────────────────────────────────────────────────
Pooled SD for computing Cohen’s d: 0.436
No need to adjust p values.</p>
<p>Disclaimer:
By default, pooled SD is Root Mean Square Error (RMSE).
There is much disagreement on how to compute Cohen’s d.
You are completely responsible for setting <code>sd.pooled</code>.
You might also use <code>effectsize::t_to_d()</code> to compute d.</p>
</div>
<div id="知识延申单因素方差分析示例" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> 知识延申|单因素方差分析示例<a href="第八讲回归模型一.html#知识延申单因素方差分析示例" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在本节课中，我们讲解了单因素方差分析和多因素方差分析，并重点讲解了多因素方差分析。我们提到了R中自带的函数以及其他一些适合心理学研究者使用的包，如PR和fx。这些包的输出结果与SPSS的输出结果非常相似，因此可以让老师和同学们更加放心地使用R进行分析。</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="第八讲回归模型一.html#cb335-1" tabindex="-1"></a><span class="co"># DEQ对Temperature的影响</span></span>
<span id="cb335-2"><a href="第八讲回归模型一.html#cb335-2" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> bruceR<span class="sc">::</span><span class="fu">MANOVA</span>(</span>
<span id="cb335-3"><a href="第八讲回归模型一.html#cb335-3" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb335-4"><a href="第八讲回归模型一.html#cb335-4" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">&quot;Temperature&quot;</span>,</span>
<span id="cb335-5"><a href="第八讲回归模型一.html#cb335-5" tabindex="-1"></a>  <span class="at">between =</span> <span class="st">&quot;climate&quot;</span>) </span></code></pre></div>
<pre><code>## 
## ====== ANOVA (Between-Subjects Design) ======
## 
## Descriptives:
## ─────────────────────────────
##  &quot;climate&quot;   Mean    S.D.   n
## ─────────────────────────────
##       热带 36.555 (0.411) 396
##       温带 36.377 (0.401) 592
##     寒温带 36.255 (0.504) 439
## ─────────────────────────────
## Total sample size: N = 1427
## 
## ANOVA Table:
## Dependent variable(s):      Temperature
## Between-subjects factor(s): climate
## Within-subjects factor(s):  –
## Covariate(s):               –
## ───────────────────────────────────────────────────────────────────────
##             MS   MSE df1  df2      F     p     η²p [90% CI of η²p]  η²G
## ───────────────────────────────────────────────────────────────────────
## climate  9.408 0.192   2 1424 49.106 &lt;.001 ***   .065 [.045, .085] .065
## ───────────────────────────────────────────────────────────────────────
## MSE = mean square error (the residual variance of the linear model)
## η²p = partial eta-squared = SS / (SS + SSE) = F * df1 / (F * df1 + df2)
## ω²p = partial omega-squared = (F - 1) * df1 / (F * df1 + df2 + 1)
## η²G = generalized eta-squared (see Olejnik &amp; Algina, 2003)
## Cohen’s f² = η²p / (1 - η²p)
## 
## Levene’s Test for Homogeneity of Variance:
## ──────────────────────────────────────────────
##                  Levene’s F df1  df2     p    
## ──────────────────────────────────────────────
## DV: Temperature      18.207   2 1424 &lt;.001 ***
## ──────────────────────────────────────────────</code></pre>
</div>
<div id="知识延申总结" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> 知识延申|总结<a href="第八讲回归模型一.html#知识延申总结" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>此外，我们还讨论了线性模型与<em>t</em>检验之间的关系。可能有些同学在理解这部分内容时会感到困惑，这时候建议大家回顾一下本科阶段的教材，加深对回归模型和<em>t</em>检验之间关系的理解。学习代码和应用是很重要的，但要正确地使用它们，还需要掌握背后的统计知识。</p>
<p>总之，通过学习本节课的内容，我们可以更好地理解方差分析的原理和应用，并能够在R中使用相应的函数进行实际分析。同时，我们也要意识到，在学习和使用R进行统计分析时，理解和掌握背后的统计知识是非常重要的。</p>
<p>课堂总结</p>
<p><img src="pic/chp8/route.png" /></p>
<p>在今天的课程中，我们讨论了方差分析的原理和应用，并在R中使用了相关函数进行实际分析。我们还提到了一个国外博客，这个博客指出许多常见的统计检验都是线性模型的特例。这可以帮助大家更好地理解这些统计方法之间的联系。</p>
<p>最后，我们留了一个思考题：对于重复测量设计（within-subject design），如何用回归模型进行分析？此外，我们还给出了一些课堂练习，建议大家尝试自己编写代码来完成这些练习，以加深对课程内容的理解。</p>
<p>本节课在此结束。感谢大家的参与，如果有任何问题，请随时提问。</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="第七讲描述性统计与数据可视化基础.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="第九讲回归模型二分层线性模型.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hcp4715/R4PsyBook/tree/main/Book/1008-lesson8_2024.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
