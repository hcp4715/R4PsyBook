<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 第十二讲：数据可视化进阶 | R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)</title>
  <meta name="description" content="课程bookdown" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 第十二讲：数据可视化进阶 | R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="课程bookdown" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 第十二讲：数据可视化进阶 | R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)" />
  
  <meta name="twitter:description" content="课程bookdown" />
  

<meta name="author" content="胡传鹏" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="第十讲回归模型三广义线性模型.html"/>
<link rel="next" href="第十四讲心理学元分析入门.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.32/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 教学内容与课时</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#目录"><i class="fa fa-check"></i><b>1.1</b> 目录</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lesson-1.html"><a href="lesson-1.html"><i class="fa fa-check"></i><b>2</b> 第一讲：为什么要学习R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lesson-1.html"><a href="lesson-1.html#r在心理科学及社会科学中的运用"><i class="fa fa-check"></i><b>2.1</b> R在心理科学及社会科学中的运用</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lesson-1.html"><a href="lesson-1.html#id_1-data-science"><i class="fa fa-check"></i><b>2.1.1</b> 数据科学</a></li>
<li class="chapter" data-level="2.1.2" data-path="lesson-1.html"><a href="lesson-1.html#id_1-data-science-born"><i class="fa fa-check"></i><b>2.1.2</b> 数据科学的诞生——数字化时代</a></li>
<li class="chapter" data-level="2.1.3" data-path="lesson-1.html"><a href="lesson-1.html#为什么要学习r语言1-why-learn-r"><i class="fa fa-check"></i><b>2.1.3</b> 为什么要学习R语言？{1-why-learn-R}</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lesson-1.html"><a href="lesson-1.html#r语言使用的示例展示"><i class="fa fa-check"></i><b>2.2</b> R语言使用的示例展示</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="lesson-1.html"><a href="lesson-1.html#数据清洗"><i class="fa fa-check"></i><b>2.2.1</b> 数据清洗</a></li>
<li class="chapter" data-level="2.2.2" data-path="lesson-1.html"><a href="lesson-1.html#ggplot2画图"><i class="fa fa-check"></i><b>2.2.2</b> ggplot2画图</a></li>
<li class="chapter" data-level="2.2.3" data-path="lesson-1.html"><a href="lesson-1.html#心理学数据分析与结果汇报"><i class="fa fa-check"></i><b>2.2.3</b> 心理学数据分析与结果汇报</a></li>
<li class="chapter" data-level="2.2.4" data-path="lesson-1.html"><a href="lesson-1.html#regression"><i class="fa fa-check"></i><b>2.2.4</b> Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lesson-1.html"><a href="lesson-1.html#现场运行代码"><i class="fa fa-check"></i><b>2.3</b> 现场运行代码</a></li>
<li class="chapter" data-level="2.4" data-path="lesson-1.html"><a href="lesson-1.html#课程安排"><i class="fa fa-check"></i><b>2.4</b> 课程安排</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="lesson-1.html"><a href="lesson-1.html#课程大纲"><i class="fa fa-check"></i><b>2.4.1</b> 课程大纲</a></li>
<li class="chapter" data-level="2.4.2" data-path="lesson-1.html"><a href="lesson-1.html#成绩分配"><i class="fa fa-check"></i><b>2.4.2</b> 成绩分配</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="lesson-1.html"><a href="lesson-1.html#如何学好这门课"><i class="fa fa-check"></i><b>2.5</b> 如何学好这门课</a></li>
<li class="chapter" data-level="2.6" data-path="lesson-1.html"><a href="lesson-1.html#课程总结与期望"><i class="fa fa-check"></i><b>2.6</b> 课程总结与期望</a></li>
<li class="chapter" data-level="2.7" data-path="lesson-1.html"><a href="lesson-1.html#推荐"><i class="fa fa-check"></i><b>2.7</b> 推荐</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html"><i class="fa fa-check"></i><b>3</b> 第二讲：如何开始使用R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#数据分析的出发点问题"><i class="fa fa-check"></i><b>3.1</b> 数据分析的出发点——问题</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#问题一-人类企鹅计划问卷数据"><i class="fa fa-check"></i><b>3.1.1</b> 问题一: 人类企鹅计划（问卷数据）</a></li>
<li class="chapter" data-level="3.1.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#问题二认知决策任务反应时和反应选择数据"><i class="fa fa-check"></i><b>3.1.2</b> 问题二：认知决策任务（反应时和反应选择数据）</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#如何安装r"><i class="fa fa-check"></i><b>3.2</b> 如何安装R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#r的下载与安装"><i class="fa fa-check"></i><b>3.2.1</b> R的下载与安装</a></li>
<li class="chapter" data-level="3.2.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#r-console控制台"><i class="fa fa-check"></i><b>3.2.2</b> R console（控制台）</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#如何安装rstudio"><i class="fa fa-check"></i><b>3.3</b> 如何安装Rstudio</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#rstuio的下载与安装"><i class="fa fa-check"></i><b>3.3.1</b> Rstuio的下载与安装</a></li>
<li class="chapter" data-level="3.3.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#测试rstudio"><i class="fa fa-check"></i><b>3.3.2</b> 测试Rstudio</a></li>
<li class="chapter" data-level="3.3.3" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#创建新项目"><i class="fa fa-check"></i><b>3.3.3</b> 创建新项目</a></li>
<li class="chapter" data-level="3.3.4" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#包packages的介绍与调用"><i class="fa fa-check"></i><b>3.3.4</b> 包(packages)的介绍与调用</a></li>
<li class="chapter" data-level="3.3.5" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#镜像的选择"><i class="fa fa-check"></i><b>3.3.5</b> 镜像的选择</a></li>
<li class="chapter" data-level="3.3.6" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#安装rtoolswindows"><i class="fa fa-check"></i><b>3.3.6</b> 安装Rtools（windows）</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#如何通过和鲸model-whale使用r"><i class="fa fa-check"></i><b>3.4</b> 如何通过和鲸（Model Whale）使用R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html"><i class="fa fa-check"></i><b>4</b> 第三讲：Git &amp; RStudio工作流</a>
<ul>
<li class="chapter" data-level="4.1" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#files-and-folders-system"><i class="fa fa-check"></i><b>4.1</b> Files and Folders System</a></li>
<li class="chapter" data-level="4.2" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#git-and-git-hub"><i class="fa fa-check"></i><b>4.2</b> Git and Git Hub</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#git"><i class="fa fa-check"></i><b>4.2.1</b> Git</a></li>
<li class="chapter" data-level="4.2.2" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#git-hub"><i class="fa fa-check"></i><b>4.2.2</b> Git Hub</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#local-version-control"><i class="fa fa-check"></i><b>4.3</b> Local Version Control</a></li>
<li class="chapter" data-level="4.4" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#remote-version-control"><i class="fa fa-check"></i><b>4.4</b> Remote Version Control</a></li>
<li class="chapter" data-level="4.5" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#作业"><i class="fa fa-check"></i><b>4.5</b> 作业</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html"><i class="fa fa-check"></i><b>5</b> 第四讲：如何导入数据</a>
<ul>
<li class="chapter" data-level="5.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#正式开始前的tips"><i class="fa fa-check"></i><b>5.1</b> 正式开始前的Tips</a></li>
<li class="chapter" data-level="5.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#回顾与问题"><i class="fa fa-check"></i><b>5.2</b> 回顾与问题</a></li>
<li class="chapter" data-level="5.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据导入"><i class="fa fa-check"></i><b>5.3</b> 数据导入</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据的住址路径-以mac系统为例"><i class="fa fa-check"></i><b>5.3.1</b> 数据的“住址”——路径 (以Mac系统为例)</a></li>
<li class="chapter" data-level="5.3.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#绝对路径相对路径"><i class="fa fa-check"></i><b>5.3.2</b> 绝对路径/相对路径</a></li>
<li class="chapter" data-level="5.3.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#设定工作目录-手动挡与自动挡"><i class="fa fa-check"></i><b>5.3.3</b> 设定工作目录 – 手动挡与自动挡</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#读取数据"><i class="fa fa-check"></i><b>5.4</b> 读取数据</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#读取数据手动档"><i class="fa fa-check"></i><b>5.4.1</b> 读取数据——手动档</a></li>
<li class="chapter" data-level="5.4.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#读取数据自动挡gui点击操作"><i class="fa fa-check"></i><b>5.4.2</b> 读取数据——自动挡(GUI点击操作)</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据类型"><i class="fa fa-check"></i><b>5.5</b> 数据类型</a></li>
<li class="chapter" data-level="5.6" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据结构"><i class="fa fa-check"></i><b>5.6</b> 数据结构</a></li>
<li class="chapter" data-level="5.7" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引"><i class="fa fa-check"></i><b>5.7</b> 数据索引</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引中括号"><i class="fa fa-check"></i><b>5.7.1</b> 数据索引(中括号)</a></li>
<li class="chapter" data-level="5.7.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引-1"><i class="fa fa-check"></i><b>5.7.2</b> 数据索引($)</a></li>
<li class="chapter" data-level="5.7.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引逻辑值"><i class="fa fa-check"></i><b>5.7.3</b> 数据索引(逻辑值)</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#对象object"><i class="fa fa-check"></i><b>5.8</b> 对象（object）</a></li>
<li class="chapter" data-level="5.9" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#其它注意事项"><i class="fa fa-check"></i><b>5.9</b> 其它注意事项</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#变量命名"><i class="fa fa-check"></i><b>5.9.1</b> 变量命名</a></li>
<li class="chapter" data-level="5.9.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#缺失值na-空值null"><i class="fa fa-check"></i><b>5.9.2</b> 缺失值（NA） 空值（NULL）</a></li>
<li class="chapter" data-level="5.9.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据类型的转换"><i class="fa fa-check"></i><b>5.9.3</b> 数据类型的转换</a></li>
<li class="chapter" data-level="5.9.4" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#目录和文件管理函数"><i class="fa fa-check"></i><b>5.9.4</b> 目录和文件管理函数:</a></li>
<li class="chapter" data-level="5.9.5" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#对象与变量名"><i class="fa fa-check"></i><b>5.9.5</b> 对象与变量名</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#final-project期末作业"><i class="fa fa-check"></i><b>5.10</b> final project（期末作业）</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#requirements"><i class="fa fa-check"></i><b>5.10.1</b> Requirements</a></li>
<li class="chapter" data-level="5.10.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#评分标准"><i class="fa fa-check"></i><b>5.10.2</b> 评分标准</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lesson-5.html"><a href="lesson-5.html"><i class="fa fa-check"></i><b>6</b> 第五讲：R语言中的对象2: 函数</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lesson-5.html"><a href="lesson-5.html#加载数据"><i class="fa fa-check"></i><b>6.1</b> 加载数据</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="lesson-5.html"><a href="lesson-5.html#数据的地址路径"><i class="fa fa-check"></i><b>6.1.1</b> 数据的“地址”——路径</a></li>
<li class="chapter" data-level="6.1.2" data-path="lesson-5.html"><a href="lesson-5.html#绝对路径与相对路径"><i class="fa fa-check"></i><b>6.1.2</b> 绝对路径与相对路径</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="lesson-5.html"><a href="lesson-5.html#读取数据-1"><i class="fa fa-check"></i><b>6.2</b> 读取数据</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lesson-5.html"><a href="lesson-5.html#手动导入"><i class="fa fa-check"></i><b>6.2.1</b> 手动导入</a></li>
<li class="chapter" data-level="6.2.2" data-path="lesson-5.html"><a href="lesson-5.html#代码导入"><i class="fa fa-check"></i><b>6.2.2</b> 代码导入</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lesson-5.html"><a href="lesson-5.html#赋值"><i class="fa fa-check"></i><b>6.3</b> 赋值</a></li>
<li class="chapter" data-level="6.4" data-path="lesson-5.html"><a href="lesson-5.html#数据类型-1"><i class="fa fa-check"></i><b>6.4</b> 数据类型</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="lesson-5.html"><a href="lesson-5.html#单个元素"><i class="fa fa-check"></i><b>6.4.1</b> 单个元素</a></li>
<li class="chapter" data-level="6.4.2" data-path="lesson-5.html"><a href="lesson-5.html#数值型numeric"><i class="fa fa-check"></i><b>6.4.2</b> 数值型(numeric)</a></li>
<li class="chapter" data-level="6.4.3" data-path="lesson-5.html"><a href="lesson-5.html#字符串character"><i class="fa fa-check"></i><b>6.4.3</b> 字符串(character)</a></li>
<li class="chapter" data-level="6.4.4" data-path="lesson-5.html"><a href="lesson-5.html#逻辑值logical"><i class="fa fa-check"></i><b>6.4.4</b> 逻辑值(logical)</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="lesson-5.html"><a href="lesson-5.html#数据结构-1"><i class="fa fa-check"></i><b>6.5</b> 数据结构</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="lesson-5.html"><a href="lesson-5.html#向量vector"><i class="fa fa-check"></i><b>6.5.1</b> 向量(vector)</a></li>
<li class="chapter" data-level="6.5.2" data-path="lesson-5.html"><a href="lesson-5.html#类型转换"><i class="fa fa-check"></i><b>6.5.2</b> 类型转换</a></li>
<li class="chapter" data-level="6.5.3" data-path="lesson-5.html"><a href="lesson-5.html#向量循环"><i class="fa fa-check"></i><b>6.5.3</b> 向量循环</a></li>
<li class="chapter" data-level="6.5.4" data-path="lesson-5.html"><a href="lesson-5.html#向量的索引"><i class="fa fa-check"></i><b>6.5.4</b> 向量的索引</a></li>
<li class="chapter" data-level="6.5.5" data-path="lesson-5.html"><a href="lesson-5.html#因子factor"><i class="fa fa-check"></i><b>6.5.5</b> 因子(factor)</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="lesson-5.html"><a href="lesson-5.html#数据框"><i class="fa fa-check"></i><b>6.6</b> 数据框</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="lesson-5.html"><a href="lesson-5.html#数据框的索引"><i class="fa fa-check"></i><b>6.6.1</b> 数据框的索引</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="lesson-5.html"><a href="lesson-5.html#矩阵与数组"><i class="fa fa-check"></i><b>6.7</b> 矩阵与数组</a></li>
<li class="chapter" data-level="6.8" data-path="lesson-5.html"><a href="lesson-5.html#列表"><i class="fa fa-check"></i><b>6.8</b> 列表</a></li>
<li class="chapter" data-level="6.9" data-path="lesson-5.html"><a href="lesson-5.html#函数"><i class="fa fa-check"></i><b>6.9</b> 函数</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="lesson-5.html"><a href="lesson-5.html#函数的调用"><i class="fa fa-check"></i><b>6.9.1</b> 函数的调用</a></li>
<li class="chapter" data-level="6.9.2" data-path="lesson-5.html"><a href="lesson-5.html#自定义函数"><i class="fa fa-check"></i><b>6.9.2</b> 自定义函数</a></li>
<li class="chapter" data-level="6.9.3" data-path="lesson-5.html"><a href="lesson-5.html#函数的组成"><i class="fa fa-check"></i><b>6.9.3</b> 函数的组成</a></li>
<li class="chapter" data-level="6.9.4" data-path="lesson-5.html"><a href="lesson-5.html#函数的简写"><i class="fa fa-check"></i><b>6.9.4</b> 函数的简写</a></li>
<li class="chapter" data-level="6.9.5" data-path="lesson-5.html"><a href="lesson-5.html#if-条件语句"><i class="fa fa-check"></i><b>6.9.5</b> if 条件语句</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html"><i class="fa fa-check"></i><b>7</b> 第六讲：数据预处理</a>
<ul>
<li class="chapter" data-level="7.1" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#tidyverse"><i class="fa fa-check"></i><b>7.1</b> <strong>Tidyverse</strong></a></li>
<li class="chapter" data-level="7.2" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#问卷数据"><i class="fa fa-check"></i><b>7.2</b> 问卷数据</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#研究问题数据情况"><i class="fa fa-check"></i><b>7.2.1</b> 研究问题&amp;数据情况</a></li>
<li class="chapter" data-level="7.2.2" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#操作步骤完整的管道操作"><i class="fa fa-check"></i><b>7.2.2</b> 操作步骤|完整的管道操作</a></li>
<li class="chapter" data-level="7.2.3" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#小结"><i class="fa fa-check"></i><b>7.2.3</b> 小结</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#反应时数据"><i class="fa fa-check"></i><b>7.3</b> 反应时数据</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#研究问题-数据情况"><i class="fa fa-check"></i><b>7.3.1</b> 研究问题 &amp; 数据情况</a></li>
<li class="chapter" data-level="7.3.2" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#操作步骤"><i class="fa fa-check"></i><b>7.3.2</b> 操作步骤</a></li>
<li class="chapter" data-level="7.3.3" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#小结-1"><i class="fa fa-check"></i><b>7.3.3</b> 小结</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html"><i class="fa fa-check"></i><b>8</b> 第七讲：描述性统计与数据可视化基础</a>
<ul>
<li class="chapter" data-level="8.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#回顾"><i class="fa fa-check"></i><b>8.1</b> 回顾</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#批量导入数据"><i class="fa fa-check"></i><b>8.1.1</b> 批量导入数据</a></li>
<li class="chapter" data-level="8.1.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#代码书写规范"><i class="fa fa-check"></i><b>8.1.2</b> 代码书写规范</a></li>
<li class="chapter" data-level="8.1.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#数据清洗-1"><i class="fa fa-check"></i><b>8.1.3</b> 数据清洗</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#探索性数据分析"><i class="fa fa-check"></i><b>8.2</b> 探索性数据分析</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#常用函数介绍"><i class="fa fa-check"></i><b>8.2.1</b> 常用函数介绍</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#数据可视化"><i class="fa fa-check"></i><b>8.3</b> 数据可视化</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#可视化的重要性"><i class="fa fa-check"></i><b>8.3.1</b> 可视化的重要性</a></li>
<li class="chapter" data-level="8.3.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#可视化的逻辑"><i class="fa fa-check"></i><b>8.3.2</b> 可视化的逻辑</a></li>
<li class="chapter" data-level="8.3.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#单个图片的组成"><i class="fa fa-check"></i><b>8.3.3</b> 单个图片的组成</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#常用图形"><i class="fa fa-check"></i><b>8.4</b> 常用图形</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#直方图"><i class="fa fa-check"></i><b>8.4.1</b> 直方图</a></li>
<li class="chapter" data-level="8.4.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#直方图密度图"><i class="fa fa-check"></i><b>8.4.2</b> 直方图+密度图</a></li>
<li class="chapter" data-level="8.4.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#箱线图"><i class="fa fa-check"></i><b>8.4.3</b> 箱线图</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#data-explorer"><i class="fa fa-check"></i><b>8.5</b> Data Explorer</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#data-explorer-1"><i class="fa fa-check"></i><b>8.5.1</b> Data Explorer</a></li>
<li class="chapter" data-level="8.5.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#使用ggpairs"><i class="fa fa-check"></i><b>8.5.2</b> 使用ggpairs</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#练习"><i class="fa fa-check"></i><b>8.6</b> 练习</a></li>
<li class="chapter" data-level="8.7" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#参考阅读"><i class="fa fa-check"></i><b>8.7</b> 参考阅读</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html"><i class="fa fa-check"></i><b>9</b> 第十讲：回归模型(三)：广义线性模型</a>
<ul>
<li class="chapter" data-level="9.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#前章回顾和本章数据预处理"><i class="fa fa-check"></i><b>9.1</b> 前章回顾和本章数据预处理</a></li>
<li class="chapter" data-level="9.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#广义线性模型"><i class="fa fa-check"></i><b>9.2</b> 广义线性模型</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#回归方程和普通线性模型"><i class="fa fa-check"></i><b>9.2.1</b> 回归方程和普通线性模型</a></li>
<li class="chapter" data-level="9.2.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#连接函数和广义线性模型"><i class="fa fa-check"></i><b>9.2.2</b> 连接函数和广义线性模型</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#二项分布"><i class="fa fa-check"></i><b>9.3</b> 二项分布</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#伯努利实验"><i class="fa fa-check"></i><b>9.3.1</b> 伯努利实验</a></li>
<li class="chapter" data-level="9.3.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#glm代码实操"><i class="fa fa-check"></i><b>9.3.2</b> GLM代码实操</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#不同方法比较"><i class="fa fa-check"></i><b>9.4</b> 不同方法比较</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#不同的建模方法"><i class="fa fa-check"></i><b>9.4.1</b> 不同的建模方法</a></li>
<li class="chapter" data-level="9.4.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#不同的模型比较方法"><i class="fa fa-check"></i><b>9.4.2</b> 不同的模型比较方法</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#其他分布"><i class="fa fa-check"></i><b>9.5</b> 其他分布</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html"><i class="fa fa-check"></i><b>10</b> 第十二讲：数据可视化进阶</a>
<ul>
<li class="chapter" data-level="10.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#作图的必要性和作图数据处理"><i class="fa fa-check"></i><b>10.1</b> 作图的必要性和作图数据处理</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#为什么要作图以及作图的原则"><i class="fa fa-check"></i><b>10.1.1</b> 为什么要作图以及作图的原则</a></li>
<li class="chapter" data-level="10.1.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#作图数据准备"><i class="fa fa-check"></i><b>10.1.2</b> 作图数据准备</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#基础作图"><i class="fa fa-check"></i><b>10.2</b> 基础作图</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#ggplot2基础回顾"><i class="fa fa-check"></i><b>10.2.1</b> ggplot2基础回顾</a></li>
<li class="chapter" data-level="10.2.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#主要图层"><i class="fa fa-check"></i><b>10.2.2</b> 主要图层</a></li>
<li class="chapter" data-level="10.2.3" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#可选图层"><i class="fa fa-check"></i><b>10.2.3</b> 可选图层</a></li>
<li class="chapter" data-level="10.2.4" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#同时呈现多张图片"><i class="fa fa-check"></i><b>10.2.4</b> 同时呈现多张图片</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#进阶作图"><i class="fa fa-check"></i><b>10.3</b> 进阶作图</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#整体和个体效应共存的图"><i class="fa fa-check"></i><b>10.3.1</b> 整体和个体效应共存的图</a></li>
<li class="chapter" data-level="10.3.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#可视化层级模型的random-effect"><i class="fa fa-check"></i><b>10.3.2</b> 可视化层级模型的random effect</a></li>
<li class="chapter" data-level="10.3.3" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#雨云图rain-cloud-plot"><i class="fa fa-check"></i><b>10.3.3</b> 雨云图（rain cloud plot）</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#高级图片处理magick"><i class="fa fa-check"></i><b>10.4</b> 高级图片处理–magick</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html"><i class="fa fa-check"></i><b>11</b> 第十四讲：心理学元分析入门</a>
<ul>
<li class="chapter" data-level="11.1" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html#什么是元分析"><i class="fa fa-check"></i><b>11.1</b> 什么是元分析</a></li>
<li class="chapter" data-level="11.2" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html#元分析的实施"><i class="fa fa-check"></i><b>11.2</b> 元分析的实施</a></li>
<li class="chapter" data-level="11.3" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html#回顾与总结"><i class="fa fa-check"></i><b>11.3</b> 回顾与总结</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第十二讲数据可视化进阶" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> 第十二讲：数据可视化进阶<a href="第十二讲数据可视化进阶.html#第十二讲数据可视化进阶" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="作图的必要性和作图数据处理" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> 作图的必要性和作图数据处理<a href="第十二讲数据可视化进阶.html#作图的必要性和作图数据处理" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>我们在前两章对心理学和社会科学中最常用的回归模型进行了讲解，在进行统计分析的过程中，最关键的并不是如何使用r代码，而是如何正确地使用r代码，这就意味着我们不可避免地要去学习其背后的统计知识。做完了所有的分析之后，我们希望将结果以一种比较美观的方式呈现给读者，这时就涉及到了进一步的数据可视化。</p>
<p>我们在前面章节也讲到过可视化，那时主要的目的是为了对数据进行初步的探索，让我们可以快速地辨别和发现数据之间的一些关系，帮助我们更好地了解数据。而本章所要讲的数据可视化，则是针对如何画出一个可发表的图像。</p>
<div id="为什么要作图以及作图的原则" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> 为什么要作图以及作图的原则<a href="第十二讲数据可视化进阶.html#为什么要作图以及作图的原则" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>经常读论文的人可能会发现，我们读多了之后会形成一个习惯——先看标题，然后看摘要，接着就开始看文章的图标了。为什么大家会这么看呢？因为科研论文中很多时候我们就是用图表来展示我们最关键的信息。数据可视化有时候可以做到”一图胜千言”。但是要做出一张美观且直观的图片，是需要经过许多思考的。</p>
<p>我们在R中依然还是用ggplot来进行画图。那么如何画好一张图呢？首先我们要清楚自己想要通过图像达到什么样的目的，比如我们的实验流程图和最后呈现的统计分析图片，它们的目标肯定是不同的，所以不仅要知道作图的技术，还要知道用什么样的图片可以更好地传达自己的意图。</p>
<p>其次在明确了目标之后，作图也可以像翻译一样，做到信达雅三个标准。信，就是要传递足够的信息量，如果读者经常看顶刊就会发现，现在顶刊上图片的信息量越来越大，尤其在生物医药领域，一个图包含了非常多的子图，每一个子图又包含了很多元素。当然这并不一定是推荐的方式，信息量应该均衡至一眼可以看出表达信息的程度。达，就是图的逻辑性，图片的线条、图例等等要有层次感，让人可以清晰感受到元素之间的内在联系。最后的雅，就是作图要追求美观，如果对比一下普通期刊和Science、Nature这些顶刊上的图片，就会发现顶刊上的图片普遍更美观。国内也有一本图片很美观的期刊《Innovation》，期刊编辑部里甚至有专门的美工对图片色彩进行调节，这也充分体现出图片美观的重要性。</p>
<p>当然这里仅将这些原则罗列给诸位读者，要做出好看的图，还需要不断地打磨和在实践中不断提升自己的作图技巧。</p>
</div>
<div id="作图数据准备" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> 作图数据准备<a href="第十二讲数据可视化进阶.html#作图数据准备" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>我们先来导入本章所要用到的包。</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="第十二讲数据可视化进阶.html#cb325-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&#39;pacman&#39;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb325-2"><a href="第十二讲数据可视化进阶.html#cb325-2" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">&#39;pacman&#39;</span>)</span>
<span id="cb325-3"><a href="第十二讲数据可视化进阶.html#cb325-3" tabindex="-1"></a>}</span>
<span id="cb325-4"><a href="第十二讲数据可视化进阶.html#cb325-4" tabindex="-1"></a></span>
<span id="cb325-5"><a href="第十二讲数据可视化进阶.html#cb325-5" tabindex="-1"></a></span>
<span id="cb325-6"><a href="第十二讲数据可视化进阶.html#cb325-6" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb325-7"><a href="第十二讲数据可视化进阶.html#cb325-7" tabindex="-1"></a>  <span class="co"># 本节课需要用到的 packages</span></span>
<span id="cb325-8"><a href="第十二讲数据可视化进阶.html#cb325-8" tabindex="-1"></a>  here, tidyverse, reshape, bruceR, ggplot2, patchwork, magick, ggdist)</span>
<span id="cb325-9"><a href="第十二讲数据可视化进阶.html#cb325-9" tabindex="-1"></a></span>
<span id="cb325-10"><a href="第十二讲数据可视化进阶.html#cb325-10" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">99999</span>,<span class="at">digits =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>数据仍然是之前所用到的认知实验的数据，这里我们为了方便仅选取了match条件下的数据。我们之前发现Valence和Identity之间有显著的交互作用，作图开始时首先会想到的就是两条交叉的线，两条线的端点分别是各个条件下的均值，因此我们需要先得到各个条件下面的均值。</p>
<p>首先这是实验中每个试次的数据。</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="第十二讲数据可视化进阶.html#cb326-1" tabindex="-1"></a>df.match.trial <span class="ot">&lt;-</span> bruceR<span class="sc">::</span><span class="fu">import</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&#39;data&#39;</span>,<span class="st">&#39;match&#39;</span>,<span class="st">&#39;match_raw.csv&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb326-2"><a href="第十二讲数据可视化进阶.html#cb326-2" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">extract</span>(Shape, </span>
<span id="cb326-3"><a href="第十二讲数据可视化进阶.html#cb326-3" tabindex="-1"></a>                 <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&#39;Valence&#39;</span>, <span class="st">&#39;Identity&#39;</span>),</span>
<span id="cb326-4"><a href="第十二讲数据可视化进阶.html#cb326-4" tabindex="-1"></a>                 <span class="at">regex =</span> <span class="st">&#39;(moral|immoral)(Self|Other)&#39;</span>,</span>
<span id="cb326-5"><a href="第十二讲数据可视化进阶.html#cb326-5" tabindex="-1"></a>                 <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="co">#将Shape列分为两列</span></span>
<span id="cb326-6"><a href="第十二讲数据可视化进阶.html#cb326-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Valence =</span> <span class="fu">factor</span>(Valence, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;moral&#39;</span>,<span class="st">&#39;immoral&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;moral&#39;</span>,<span class="st">&#39;immoral&#39;</span>)),</span>
<span id="cb326-7"><a href="第十二讲数据可视化进阶.html#cb326-7" tabindex="-1"></a>                <span class="at">Identity =</span> <span class="fu">factor</span>(Identity, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;Self&#39;</span>,<span class="st">&#39;Other&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Self&#39;</span>,<span class="st">&#39;Other&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb326-8"><a href="第十二讲数据可视化进阶.html#cb326-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(ACC <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> ACC <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb326-9"><a href="第十二讲数据可视化进阶.html#cb326-9" tabindex="-1"></a>                RT <span class="sc">&gt;=</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> RT <span class="sc">&lt;=</span> <span class="fl">1.5</span>,</span>
<span id="cb326-10"><a href="第十二讲数据可视化进阶.html#cb326-10" tabindex="-1"></a>                Match <span class="sc">==</span> <span class="st">&#39;match&#39;</span>,</span>
<span id="cb326-11"><a href="第十二讲数据可视化进阶.html#cb326-11" tabindex="-1"></a>                (<span class="sc">!</span>Sub <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7302</span>,<span class="dv">7303</span>,<span class="dv">7338</span>))) </span>
<span id="cb326-12"><a href="第十二讲数据可视化进阶.html#cb326-12" tabindex="-1"></a></span>
<span id="cb326-13"><a href="第十二讲数据可视化进阶.html#cb326-13" tabindex="-1"></a><span class="fu">head</span>(df.match.trial, <span class="dv">4</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-343e489e5236f671116b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-343e489e5236f671116b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],["06-May-2018_14:45:42","06-May-2018_14:45:44","06-May-2018_14:45:50","06-May-2018_14:45:53"],["Exp","Exp","Exp","Exp"],[7304,7304,7304,7304],[25,25,25,25],["female","female","female","female"],["R","R","R","R"],[1,1,1,1],[1,1,1,1],[3,4,7,8],["moralOther","immoralOther","moralSelf","immoralOther"],["moral","immoral","moral","immoral"],["Other","Other","Self","Other"],["moralOther","immoralOther","moralSelf","immoralOther"],["match","match","match","match"],["n","n","n","n"],["n","m","n","m"],[1,0,1,0],[0.8167,0.8728,0.4951,0.8713]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Date<\/th>\n      <th>Prac<\/th>\n      <th>Sub<\/th>\n      <th>Age<\/th>\n      <th>Sex<\/th>\n      <th>Hand<\/th>\n      <th>Block<\/th>\n      <th>Bin<\/th>\n      <th>Trial<\/th>\n      <th>Shape<\/th>\n      <th>Valence<\/th>\n      <th>Identity<\/th>\n      <th>Label<\/th>\n      <th>Match<\/th>\n      <th>CorrResp<\/th>\n      <th>Resp<\/th>\n      <th>ACC<\/th>\n      <th>RT<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,7,8,9,17,18]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Date","targets":1},{"name":"Prac","targets":2},{"name":"Sub","targets":3},{"name":"Age","targets":4},{"name":"Sex","targets":5},{"name":"Hand","targets":6},{"name":"Block","targets":7},{"name":"Bin","targets":8},{"name":"Trial","targets":9},{"name":"Shape","targets":10},{"name":"Valence","targets":11},{"name":"Identity","targets":12},{"name":"Label","targets":13},{"name":"Match","targets":14},{"name":"CorrResp","targets":15},{"name":"Resp","targets":16},{"name":"ACC","targets":17},{"name":"RT","targets":18}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>接下来我们整合试次，得到每个被试在4中条件下的均值。</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="第十二讲数据可视化进阶.html#cb327-1" tabindex="-1"></a>df.match.subj <span class="ot">&lt;-</span> df.match.trial <span class="sc">%&gt;%</span></span>
<span id="cb327-2"><a href="第十二讲数据可视化进阶.html#cb327-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Sub, Identity, Valence) <span class="sc">%&gt;%</span></span>
<span id="cb327-3"><a href="第十二讲数据可视化进阶.html#cb327-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">RT_mean =</span> <span class="fu">mean</span>(RT), </span>
<span id="cb327-4"><a href="第十二讲数据可视化进阶.html#cb327-4" tabindex="-1"></a>                   <span class="at">ACC_mean =</span> <span class="fu">mean</span>(ACC)) <span class="sc">%&gt;%</span></span>
<span id="cb327-5"><a href="第十二讲数据可视化进阶.html#cb327-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span>
<span id="cb327-6"><a href="第十二讲数据可视化进阶.html#cb327-6" tabindex="-1"></a></span>
<span id="cb327-7"><a href="第十二讲数据可视化进阶.html#cb327-7" tabindex="-1"></a><span class="fu">head</span>(df.match.subj, <span class="dv">4</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-2b5b141c77a3531629c4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2b5b141c77a3531629c4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],[7304,7304,7304,7304],["Self","Self","Other","Other"],["moral","immoral","moral","immoral"],[0.552276,0.706672602739726,0.7493875,0.7581492957746478],[0.9866666666666667,0.821917808219178,0.8333333333333334,0.7183098591549296]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Sub<\/th>\n      <th>Identity<\/th>\n      <th>Valence<\/th>\n      <th>RT_mean<\/th>\n      <th>ACC_mean<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Sub","targets":1},{"name":"Identity","targets":2},{"name":"Valence","targets":3},{"name":"RT_mean","targets":4},{"name":"ACC_mean","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>因为我们在作图时想看到的是总体的交互作用，因此我们将所有被试的数据平均得到一个总体在4种条件下的RT和ACC均值。在下面的代码中，大家可以发现SD和SE，这是因为我们在作图时还需要在均值的基础上加上误差棒（error
bar）。这里我们需要将误差棒和字母”T”进行区分，因为之前有个研究者拿字母”T”冒充误差棒，当然后来被人发现了，还在社交媒体上火了一把。这也提示我们作图时，拿最基础的柱图举例，不仅要画出集中趋势（平均值），还要画出离散趋势（误差项）。</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="第十二讲数据可视化进阶.html#cb328-1" tabindex="-1"></a>df.match.sum <span class="ot">&lt;-</span> df.match.subj <span class="sc">%&gt;%</span> </span>
<span id="cb328-2"><a href="第十二讲数据可视化进阶.html#cb328-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Identity, Valence) <span class="sc">%&gt;%</span></span>
<span id="cb328-3"><a href="第十二讲数据可视化进阶.html#cb328-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">grand_mean_RT =</span> <span class="fu">mean</span>(RT_mean),</span>
<span id="cb328-4"><a href="第十二讲数据可视化进阶.html#cb328-4" tabindex="-1"></a>                   <span class="at">SD_RT =</span> <span class="fu">sd</span>(RT_mean),</span>
<span id="cb328-5"><a href="第十二讲数据可视化进阶.html#cb328-5" tabindex="-1"></a>                   <span class="at">SE_RT =</span> SD_RT<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb328-6"><a href="第十二讲数据可视化进阶.html#cb328-6" tabindex="-1"></a>                   <span class="at">grand_mean_ACC =</span> <span class="fu">mean</span>(ACC_mean),</span>
<span id="cb328-7"><a href="第十二讲数据可视化进阶.html#cb328-7" tabindex="-1"></a>                   <span class="at">SD_ACC =</span> <span class="fu">sd</span>(ACC_mean),</span>
<span id="cb328-8"><a href="第十二讲数据可视化进阶.html#cb328-8" tabindex="-1"></a>                   <span class="at">SE_ACC =</span> SD_ACC<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb328-9"><a href="第十二讲数据可视化进阶.html#cb328-9" tabindex="-1"></a>                   <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb328-10"><a href="第十二讲数据可视化进阶.html#cb328-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span>
<span id="cb328-11"><a href="第十二讲数据可视化进阶.html#cb328-11" tabindex="-1"></a></span>
<span id="cb328-12"><a href="第十二讲数据可视化进阶.html#cb328-12" tabindex="-1"></a><span class="fu">head</span>(df.match.sum, <span class="dv">4</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-c151cb3d3f4c6ab2e591" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c151cb3d3f4c6ab2e591">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],["Self","Self","Other","Other"],["moral","immoral","moral","immoral"],[0.6366372764212784,0.7150271256631987,0.6850132435574973,0.6996564845828235],[0.06334254097700114,0.06957103122069196,0.07816459938618592,0.0695041721958588],[0.01001533511349354,0.01100014589120355,0.01235890832274734,0.01098957455117302],[0.9161836748531289,0.8142527831854576,0.8440248488102073,0.828686850170307],[0.0980144792704873,0.1197130892135965,0.1095526473381531,0.1107136186340657],[0.01549744990850493,0.01892830138249502,0.01732179446448731,0.01750536014414538],[41,41,41,41]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Identity<\/th>\n      <th>Valence<\/th>\n      <th>grand_mean_RT<\/th>\n      <th>SD_RT<\/th>\n      <th>SE_RT<\/th>\n      <th>grand_mean_ACC<\/th>\n      <th>SD_ACC<\/th>\n      <th>SE_ACC<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8,9]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Identity","targets":1},{"name":"Valence","targets":2},{"name":"grand_mean_RT","targets":3},{"name":"SD_RT","targets":4},{"name":"SE_RT","targets":5},{"name":"grand_mean_ACC","targets":6},{"name":"SD_ACC","targets":7},{"name":"SE_ACC","targets":8},{"name":"n","targets":9}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>整体的均值加上误差，这样的图在传统意义上已经足够了。但是最近七八年，大家发现如果只呈现总体趋势，这对读者是有误导性的，因为如果我们呈现每个被试数据的话，有时候会发现整体的效应量实际上没有那么大。因此后来有研究者鼓励大家在作图时不仅要可视化整体数据，还要将每个被试的数据也呈现在图上。这样能够保证读者在读图时不会过高地估计实验的效应量。</p>
</div>
</div>
<div id="基础作图" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> 基础作图<a href="第十二讲数据可视化进阶.html#基础作图" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ggplot2基础回顾" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> ggplot2基础回顾<a href="第十二讲数据可视化进阶.html#ggplot2基础回顾" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>让我们再来回顾一下ggplot的一些基础知识，gg的全称是grammar of
graphics，即作图的语法。</p>
<p><img src="pic/chp12/ggplot.png" /></p>
<p>ggplot的基本原理就是图层的叠加，这和Photoshop的逻辑是很类似的。</p>
<p><img src="pic/chp12/gramma.png" /></p>
<p>ggplot的图层叠加主要分为分为主要图层和可选图层。主要图层主要包含了数据（data），映射（aesthetics）和图形（geometries）。在代码中，便是如下图所示的，首先放入数据DATA，然后我们需要对数据建立空间上的映射MAPPINGS，最后再决定用什么样的几何图形对映射的数据进行可视化，也就是图中红色的部分，这些红色的图形又通过加号进行叠加。这就是基础的主要图层。</p>
<p><img src="pic/chp12/required.png" /></p>
</div>
<div id="主要图层" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> 主要图层<a href="第十二讲数据可视化进阶.html#主要图层" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>我们先用总体的数据来绘制主要图层。在下面的代码中，我们放入了总体数据df.match.sum；接着将x轴定义为Identity，它有两个取值”self”和”other”，y轴定义为总体的反应时；填充”fill”指的是我们所用的图例，我们将不同的Identity的柱子用Valence进行填充；最后我们用geom_bar()这一函数来定义所要画的是柱状图，再加上误差棒geom_errorbar()。这样就做出了一个2×2的条形图。</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="第十二讲数据可视化进阶.html#cb329-1" tabindex="-1"></a><span class="co"># 以柱状图为例</span></span>
<span id="cb329-2"><a href="第十二讲数据可视化进阶.html#cb329-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df.match.sum, <span class="fu">aes</span>(<span class="at">x =</span> Identity, <span class="at">y =</span> grand_mean_RT, <span class="at">fill =</span> Valence)) <span class="sc">+</span></span>
<span id="cb329-3"><a href="第十二讲数据可视化进阶.html#cb329-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;Identity&quot;</span>,</span>
<span id="cb329-4"><a href="第十二讲数据可视化进阶.html#cb329-4" tabindex="-1"></a>                    <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb329-5"><a href="第十二讲数据可视化进阶.html#cb329-5" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(<span class="at">data =</span> df.match.sum,</span>
<span id="cb329-6"><a href="第十二讲数据可视化进阶.html#cb329-6" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">ymin =</span> grand_mean_RT <span class="sc">-</span> SE_RT, <span class="at">ymax =</span> grand_mean_RT <span class="sc">+</span> SE_RT),</span>
<span id="cb329-7"><a href="第十二讲数据可视化进阶.html#cb329-7" tabindex="-1"></a>                         <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb329-8"><a href="第十二讲数据可视化进阶.html#cb329-8" tabindex="-1"></a>                         <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>))</span>
<span id="cb329-9"><a href="第十二讲数据可视化进阶.html#cb329-9" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-173-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>值得注意的是，geom_errorbar()中我们映射的是y的最大值/最小值是整体RT加上/减去SE，所以误差棒表示的是均值上下各一个标准误，虽然大部分情况下研究者都用标准误来作为误差棒，但也有会用标准差SD来作为误差棒的。另外，我们可以用width定义误差棒的宽度，position_dodge()将误差棒进行小幅度错开，这也对应了前面柱状图里面position
= “dodge”。</p>
</div>
<div id="可选图层" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> 可选图层<a href="第十二讲数据可视化进阶.html#可选图层" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>上面所绘制的图其实不太符合心理学和APA的格式要求，这种R默认绘制出来的图有一些缺点：比如背景有阴影和框线，其次y轴不是以0为起点且轴的字体不是特别突出。另外我们可以看到ggplot的默认字体是很小的，这也是很多研究者吐槽的一点，如果不对字体进行调节是比较影响作图的直观性的。</p>
<p>这些问题需要我们加入额外的图层来加以解决，这就是可选图层。例如我们可以用scale_xxx()函数自定义坐标轴的一些信息,用theme_xxx()函数来切换图片的主题。</p>
<p><img src="pic/chp12/adjust.png" /></p>
<p>这里我们直接在主要图层p1的基础上累加可选图层。下面的代码中，expand=c(0,
0)让坐标原点从零点开始；breaks = seq(0, 0.75,
0.25)使得y轴以0开始，0.75结束，以0.25作为最小单位；limits = c(0,
0.75)则限定了y轴的范围，这些都通过scale_y_continuous()这一函数来进行调节，这是因为RT是连续变量，所以对应的是”continuous”。labs()用于修改主题和y坐标轴的标题。最后我们使用papaja包下的theme_apa()函数让图片自动符合APA主题。</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="第十二讲数据可视化进阶.html#cb330-1" tabindex="-1"></a><span class="co"># 以柱状图为例</span></span>
<span id="cb330-2"><a href="第十二讲数据可视化进阶.html#cb330-2" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span></span>
<span id="cb330-3"><a href="第十二讲数据可视化进阶.html#cb330-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb330-4"><a href="第十二讲数据可视化进阶.html#cb330-4" tabindex="-1"></a>                              <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.75</span>, <span class="fl">0.25</span>), </span>
<span id="cb330-5"><a href="第十二讲数据可视化进阶.html#cb330-5" tabindex="-1"></a>                              <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb330-6"><a href="第十二讲数据可视化进阶.html#cb330-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mean RT for match trials&quot;</span>, <span class="at">y =</span> <span class="st">&quot;RT&quot;</span>) <span class="sc">+</span></span>
<span id="cb330-7"><a href="第十二讲数据可视化进阶.html#cb330-7" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>()</span>
<span id="cb330-8"><a href="第十二讲数据可视化进阶.html#cb330-8" tabindex="-1"></a></span>
<span id="cb330-9"><a href="第十二讲数据可视化进阶.html#cb330-9" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-174-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>这里绘制的图整体是符合APA格式的，它以零点作为起点，没有背景的灰色和框线。同理，我们将主要图层和可选图层全部写在一起，可以得到ACC的图。</p>
<p><img src="_main_files/figure-html/unnamed-chunk-175-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="同时呈现多张图片" class="section level3 hasAnchor" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> 同时呈现多张图片<a href="第十二讲数据可视化进阶.html#同时呈现多张图片" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>现在我们有了两张图，一张RT，一张ACC，我们希望让这两张图一起呈现，那么我们应该如何将二者拼在一起呢？这里我们将介绍两种方法。</p>
<p>第一种方法是分面(Facet)，我们可以把画框当作一个面板，只要我们在数据框里面有分类的变量作为依据，就可以据此将不同的图片绘制在面板上。Facet也可以被认为是图层的一种，也是通过”+“加号叠加在原始图片上，可以分为一维(facet_wrap)和二维(facet_grid)两种，下图所示为二维，由于不同的子图之间有很多变量是相同的，这样陈列在一起方便我们进行肉眼上的比较和观察。</p>
<p><img src="pic/chp12/facet.png" /></p>
<p>在我们的数据中，RT和ACC在x轴上的变量是一致的，但是y轴的因变量是不同的，因此我们需要一个额外的变量去对RT和ACC进行分类和标记，然后R才能根据这个不同的标记进行分面板的绘制和呈现。这听起来有点复杂，实际上就是意味着我们在呈现数据的时候要合并RT和ACC。在下面的代码中，我们将之前的grand_mean_RT和grand_mean_ACC全部重新命名为grand_mean，SD和SE也进行类似的操作，合并完后我们再新增一个叫做DV的变量对RT和ACC进行分类。</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="第十二讲数据可视化进阶.html#cb331-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df.match.sum[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>)]<span class="sc">%&gt;%</span></span>
<span id="cb331-2"><a href="第十二讲数据可视化进阶.html#cb331-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">grand_mean =</span> grand_mean_RT,</span>
<span id="cb331-3"><a href="第十二讲数据可视化进阶.html#cb331-3" tabindex="-1"></a>                <span class="at">SD =</span> SD_RT,</span>
<span id="cb331-4"><a href="第十二讲数据可视化进阶.html#cb331-4" tabindex="-1"></a>                <span class="at">SE =</span> SE_RT) <span class="sc">%&gt;%</span></span>
<span id="cb331-5"><a href="第十二讲数据可视化进阶.html#cb331-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">DV =</span> <span class="st">&quot;RT&quot;</span>)</span>
<span id="cb331-6"><a href="第十二讲数据可视化进阶.html#cb331-6" tabindex="-1"></a></span>
<span id="cb331-7"><a href="第十二讲数据可视化进阶.html#cb331-7" tabindex="-1"></a>df.match.sum.long <span class="ot">&lt;-</span> df.match.sum[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb331-8"><a href="第十二讲数据可视化进阶.html#cb331-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">grand_mean =</span> grand_mean_ACC,</span>
<span id="cb331-9"><a href="第十二讲数据可视化进阶.html#cb331-9" tabindex="-1"></a>                <span class="at">SD =</span> SD_ACC,</span>
<span id="cb331-10"><a href="第十二讲数据可视化进阶.html#cb331-10" tabindex="-1"></a>                <span class="at">SE =</span> SE_ACC) <span class="sc">%&gt;%</span></span>
<span id="cb331-11"><a href="第十二讲数据可视化进阶.html#cb331-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">DV =</span> <span class="st">&quot;ACC&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb331-12"><a href="第十二讲数据可视化进阶.html#cb331-12" tabindex="-1"></a>  <span class="fu">rbind</span>(df1,.)</span>
<span id="cb331-13"><a href="第十二讲数据可视化进阶.html#cb331-13" tabindex="-1"></a></span>
<span id="cb331-14"><a href="第十二讲数据可视化进阶.html#cb331-14" tabindex="-1"></a><span class="fu">rm</span>(df1)</span>
<span id="cb331-15"><a href="第十二讲数据可视化进阶.html#cb331-15" tabindex="-1"></a></span>
<span id="cb331-16"><a href="第十二讲数据可视化进阶.html#cb331-16" tabindex="-1"></a><span class="fu">head</span>(df.match.sum.long, <span class="dv">3</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-09c862dcd552c7ece001" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-09c862dcd552c7ece001">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["Self","Self","Other"],["moral","immoral","moral"],[0.6366372764212784,0.7150271256631987,0.6850132435574973],[0.06334254097700114,0.06957103122069196,0.07816459938618592],[0.01001533511349354,0.01100014589120355,0.01235890832274734],[41,41,41],["RT","RT","RT"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Identity<\/th>\n      <th>Valence<\/th>\n      <th>grand_mean<\/th>\n      <th>SD<\/th>\n      <th>SE<\/th>\n      <th>n<\/th>\n      <th>DV<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Identity","targets":1},{"name":"Valence","targets":2},{"name":"grand_mean","targets":3},{"name":"SD","targets":4},{"name":"SE","targets":5},{"name":"n","targets":6},{"name":"DV","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>此时，我们的数据框就变成了一个长形的数据，并使用DV这一列对数据因变量进行分类。合并与分类结束之后，我们就可以使用Facet来进行呈现了。在下面的代码中，
papaja::theme_apa()这一行之前其实和前面提到的代码是一致的，只是将y定义为合并之后的因变量grand_mean。这时我们需要新增的就是放入DV这一分类变量，scales
=
“free_y”表示在不同面板上y轴的单位不固定，根据数据情况来自动调整。最后根据实际情况增加一些title和轴上的label。</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="第十二讲数据可视化进阶.html#cb332-1" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> df.match.sum.long <span class="sc">%&gt;%</span></span>
<span id="cb332-2"><a href="第十二讲数据可视化进阶.html#cb332-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(., </span>
<span id="cb332-3"><a href="第十二讲数据可视化进阶.html#cb332-3" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> Identity,</span>
<span id="cb332-4"><a href="第十二讲数据可视化进阶.html#cb332-4" tabindex="-1"></a>                      <span class="at">y =</span> grand_mean,</span>
<span id="cb332-5"><a href="第十二讲数据可视化进阶.html#cb332-5" tabindex="-1"></a>                      <span class="at">fill =</span> Valence)) <span class="sc">+</span> </span>
<span id="cb332-6"><a href="第十二讲数据可视化进阶.html#cb332-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb332-7"><a href="第十二讲数据可视化进阶.html#cb332-7" tabindex="-1"></a>                    <span class="at">position=</span><span class="fu">position_dodge</span>(),</span>
<span id="cb332-8"><a href="第十二讲数据可视化进阶.html#cb332-8" tabindex="-1"></a>                    ) <span class="sc">+</span></span>
<span id="cb332-9"><a href="第十二讲数据可视化进阶.html#cb332-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> grand_mean<span class="fl">-1.96</span><span class="sc">*</span>SE,</span>
<span id="cb332-10"><a href="第十二讲数据可视化进阶.html#cb332-10" tabindex="-1"></a>                             <span class="at">ymax =</span> grand_mean<span class="fl">+1.96</span><span class="sc">*</span>SE),</span>
<span id="cb332-11"><a href="第十二讲数据可视化进阶.html#cb332-11" tabindex="-1"></a>                         <span class="at">width =</span> .<span class="dv">1</span>,</span>
<span id="cb332-12"><a href="第十二讲数据可视化进阶.html#cb332-12" tabindex="-1"></a>                         <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb332-13"><a href="第十二讲数据可视化进阶.html#cb332-13" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>() <span class="sc">+</span></span>
<span id="cb332-14"><a href="第十二讲数据可视化进阶.html#cb332-14" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>DV, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb332-15"><a href="第十二讲数据可视化进阶.html#cb332-15" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Summary data for matching trials&quot;</span>,</span>
<span id="cb332-16"><a href="第十二讲数据可视化进阶.html#cb332-16" tabindex="-1"></a>                <span class="at">x=</span><span class="st">&quot;Identity&quot;</span>,</span>
<span id="cb332-17"><a href="第十二讲数据可视化进阶.html#cb332-17" tabindex="-1"></a>                <span class="at">y=</span><span class="st">&quot;mean&quot;</span>)</span>
<span id="cb332-18"><a href="第十二讲数据可视化进阶.html#cb332-18" tabindex="-1"></a></span>
<span id="cb332-19"><a href="第十二讲数据可视化进阶.html#cb332-19" tabindex="-1"></a>p4</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-177-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>可以看到合并后的图片如上图所示，共享一个y轴标签”mean”。可以看到因为没有使用scale_y_continuous()函数对y轴进行调整，因此这里y轴的起点并不是0，读者可以参照上面的代码来完善这幅合并之后的图。</p>
<p>第二种方法是使用patchwork，这种方法比较简单粗暴，不需要进行数据预处理，直接+在一起就可以，plot_layout(guides
= “collect”)指将图例合并起来。</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="第十二讲数据可视化进阶.html#cb333-1" tabindex="-1"></a>p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-178-1.png" width="85%" style="display: block; margin: auto;" /></p>
<p>我们在图上可以观察出交互作用，红色柱子相连的话，其斜率是比绿色柱子相连的斜率更大的，也就是二者会相交。如果我们将y轴的范围缩短一些，这种交互作用的趋势将会在图上更显著地呈现出来。</p>
<p>以上所讲的这些总结起来包括了数据处理和图形美化这两部分，如下图所示（注：本图来自《R语言数据可视化之美：专业图表绘制指南》）。</p>
<p><img src="pic/chp12/summary.png" /></p>
</div>
</div>
<div id="进阶作图" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> 进阶作图<a href="第十二讲数据可视化进阶.html#进阶作图" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="整体和个体效应共存的图" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> 整体和个体效应共存的图<a href="第十二讲数据可视化进阶.html#整体和个体效应共存的图" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>刚才我们提到了研究者还希望呈现除了整体之外的被试个体的数据，这就意味着要去了解更多关于图层叠加的特点和技巧。比如我们想要得到下面这样效果的图，我们将之前的柱状图改成线的方式进行呈现，可以明显看到交互作用的存在；另外还将每一个被试的数据也放在了图上，以RT图中self的条件下为例，可以看到大部分被试跟整体趋势是一致的，也就是moral下面反应时比immoral更短，然而也有几名反过来的被试。这样就把群体水平和个体水平的信息很好地呈现在一幅图上了。那么如何做出这样的图呢？</p>
<p><img src="pic/chp12/target1.png" /></p>
<p>首先我们要画出整体的均值，映射上和刚才所做的一致，图形的选择上，我们将柱状图geom_bar()替换为线图geom_line()，并用geom_point()将线的两端变成两个较大的点，并使用position_dodge(0.5)将点和线都错开一些并且互相对齐。同样的，我们加上error
bar和修改y轴的坐标。值得注意的是，这里y轴的选取相比前面要更广，因为希望将所有被试的数据都纳入进来。以下是整体数据的线图代码。</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="第十二讲数据可视化进阶.html#cb334-1" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> df.match.sum <span class="sc">%&gt;%</span></span>
<span id="cb334-2"><a href="第十二讲数据可视化进阶.html#cb334-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(., </span>
<span id="cb334-3"><a href="第十二讲数据可视化进阶.html#cb334-3" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> Identity,</span>
<span id="cb334-4"><a href="第十二讲数据可视化进阶.html#cb334-4" tabindex="-1"></a>                      <span class="at">y =</span> grand_mean_RT,</span>
<span id="cb334-5"><a href="第十二讲数据可视化进阶.html#cb334-5" tabindex="-1"></a>                      <span class="at">group =</span> Valence,</span>
<span id="cb334-6"><a href="第十二讲数据可视化进阶.html#cb334-6" tabindex="-1"></a>                      <span class="at">color =</span> Valence)) <span class="sc">+</span></span>
<span id="cb334-7"><a href="第十二讲数据可视化进阶.html#cb334-7" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb334-8"><a href="第十二讲数据可视化进阶.html#cb334-8" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb334-9"><a href="第十二讲数据可视化进阶.html#cb334-9" tabindex="-1"></a>                      <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb334-10"><a href="第十二讲数据可视化进阶.html#cb334-10" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>grand_mean_RT<span class="sc">-</span>SE_RT,</span>
<span id="cb334-11"><a href="第十二讲数据可视化进阶.html#cb334-11" tabindex="-1"></a>                             <span class="at">ymax=</span>grand_mean_RT<span class="sc">+</span>SE_RT),</span>
<span id="cb334-12"><a href="第十二讲数据可视化进阶.html#cb334-12" tabindex="-1"></a>                         <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb334-13"><a href="第十二讲数据可视化进阶.html#cb334-13" tabindex="-1"></a>                         <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb334-14"><a href="第十二讲数据可视化进阶.html#cb334-14" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.9</span>)) <span class="sc">+</span> <span class="co">#选取能纳入全部散点的范围</span></span>
<span id="cb334-15"><a href="第十二讲数据可视化进阶.html#cb334-15" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>()</span>
<span id="cb334-16"><a href="第十二讲数据可视化进阶.html#cb334-16" tabindex="-1"></a></span>
<span id="cb334-17"><a href="第十二讲数据可视化进阶.html#cb334-17" tabindex="-1"></a>s1</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-179-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>接下来我们希望加入每个被试的数据点，依然使用geom_point()这个函数，可以注意到这里用到的是每个被试的数据df.match.subj，而不是前面的df.match.sum，代表每个被试在4种实验条件下的均值。下面是相应的代码。</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="第十二讲数据可视化进阶.html#cb335-1" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> s1 <span class="sc">+</span></span>
<span id="cb335-2"><a href="第十二讲数据可视化进阶.html#cb335-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df.match.subj,</span>
<span id="cb335-3"><a href="第十二讲数据可视化进阶.html#cb335-3" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> Identity,</span>
<span id="cb335-4"><a href="第十二讲数据可视化进阶.html#cb335-4" tabindex="-1"></a>                          <span class="at">y =</span> RT_mean,</span>
<span id="cb335-5"><a href="第十二讲数据可视化进阶.html#cb335-5" tabindex="-1"></a>                          <span class="at">group =</span> Valence))</span>
<span id="cb335-6"><a href="第十二讲数据可视化进阶.html#cb335-6" tabindex="-1"></a></span>
<span id="cb335-7"><a href="第十二讲数据可视化进阶.html#cb335-7" tabindex="-1"></a>s2</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-180-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>可以看到确实把被试的数据点画了出来，但是似乎不是很美观，所有点都叠在一起。于是我们使用position
= position_jitter(width = 0.1)这一语句将数据点抖动错开。</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="第十二讲数据可视化进阶.html#cb336-1" tabindex="-1"></a>s3 <span class="ot">&lt;-</span> s1 <span class="sc">+</span></span>
<span id="cb336-2"><a href="第十二讲数据可视化进阶.html#cb336-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df.match.subj,</span>
<span id="cb336-3"><a href="第十二讲数据可视化进阶.html#cb336-3" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> Identity, <span class="at">y =</span> RT_mean, <span class="at">group =</span> Valence),</span>
<span id="cb336-4"><a href="第十二讲数据可视化进阶.html#cb336-4" tabindex="-1"></a>                      <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>),</span>
<span id="cb336-5"><a href="第十二讲数据可视化进阶.html#cb336-5" tabindex="-1"></a>                      <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb336-6"><a href="第十二讲数据可视化进阶.html#cb336-6" tabindex="-1"></a></span>
<span id="cb336-7"><a href="第十二讲数据可视化进阶.html#cb336-7" tabindex="-1"></a>s3</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-181-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>但是我们发现数据点还是没有完全错开，moral和immoral两种条件下面的点还是混杂在一起。那么应该如何得到规律的抖动呢？可以看到上面的点是根据x轴的两个条件在进行抖动错开，实际上我们需要点根据moral和immoral进行抖动错开，因此我们需要设置新的基线。</p>
<p>我们加入新的位置变量conds。首先我们需要明白，虽然坐标轴上我们看到的x是self和other，但实际上它们真实的值是0和1，因此我们需要设置4种情况，self下的两种情况下，坐标分别是1±0.12；而other条件下则是2±0.12。</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="第十二讲数据可视化进阶.html#cb337-1" tabindex="-1"></a>df.match.plot <span class="ot">&lt;-</span> df.match.subj <span class="sc">%&gt;%</span></span>
<span id="cb337-2"><a href="第十二讲数据可视化进阶.html#cb337-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">conds =</span> <span class="fu">case_when</span>(Identity <span class="sc">==</span> <span class="st">&quot;Self&quot;</span> <span class="sc">&amp;</span> Valence <span class="sc">==</span> <span class="st">&quot;moral&quot;</span> <span class="sc">~</span> <span class="st">&quot;0.88&quot;</span>,</span>
<span id="cb337-3"><a href="第十二讲数据可视化进阶.html#cb337-3" tabindex="-1"></a>                                  Identity <span class="sc">==</span> <span class="st">&quot;Self&quot;</span> <span class="sc">&amp;</span> Valence <span class="sc">==</span> <span class="st">&quot;immoral&quot;</span> <span class="sc">~</span> <span class="st">&quot;1.12&quot;</span>,</span>
<span id="cb337-4"><a href="第十二讲数据可视化进阶.html#cb337-4" tabindex="-1"></a>                                  Identity <span class="sc">==</span> <span class="st">&quot;Other&quot;</span> <span class="sc">&amp;</span> Valence <span class="sc">==</span> <span class="st">&quot;moral&quot;</span> <span class="sc">~</span> <span class="st">&quot;1.88&quot;</span>,</span>
<span id="cb337-5"><a href="第十二讲数据可视化进阶.html#cb337-5" tabindex="-1"></a>                                  Identity <span class="sc">==</span> <span class="st">&quot;Other&quot;</span> <span class="sc">&amp;</span> Valence <span class="sc">==</span> <span class="st">&quot;immoral&quot;</span> <span class="sc">~</span> <span class="st">&quot;2.12&quot;</span>),</span>
<span id="cb337-6"><a href="第十二讲数据可视化进阶.html#cb337-6" tabindex="-1"></a>                <span class="at">conds =</span> <span class="fu">as.numeric</span>(conds))</span></code></pre></div>
<p>接下来讲conds作为x变量来画被试个体数据的点图。这时候点的基线就变成了conds下面的4种条件，而不是原来的self和other这两种基线。</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="第十二讲数据可视化进阶.html#cb338-1" tabindex="-1"></a>s4 <span class="ot">&lt;-</span> s1 <span class="sc">+</span></span>
<span id="cb338-2"><a href="第十二讲数据可视化进阶.html#cb338-2" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df.match.plot,</span>
<span id="cb338-3"><a href="第十二讲数据可视化进阶.html#cb338-3" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> conds, <span class="at">y =</span> RT_mean, <span class="at">group =</span> Valence),</span>
<span id="cb338-4"><a href="第十二讲数据可视化进阶.html#cb338-4" tabindex="-1"></a>                       <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb338-5"><a href="第十二讲数据可视化进阶.html#cb338-5" tabindex="-1"></a>                       <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb338-6"><a href="第十二讲数据可视化进阶.html#cb338-6" tabindex="-1"></a></span>
<span id="cb338-7"><a href="第十二讲数据可视化进阶.html#cb338-7" tabindex="-1"></a>s4</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-183-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>这样以来，再把个体点图叠加到原来的整体线图上时，看上去就好像处于以整体的值为中心在进行变化。至于0.12这个偏差值如何设置呢？最好的办法就是多去试，然后看那个值最合适。</p>
<p>当我们画出被试散点之后，我们还希望看到被试个体的趋势，因此我们在s4的基础上再将被试的条件值连接起来。</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="第十二讲数据可视化进阶.html#cb339-1" tabindex="-1"></a>s5 <span class="ot">&lt;-</span> s4 <span class="sc">+</span></span>
<span id="cb339-2"><a href="第十二讲数据可视化进阶.html#cb339-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> df.match.plot,</span>
<span id="cb339-3"><a href="第十二讲数据可视化进阶.html#cb339-3" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> conds, <span class="at">y =</span> RT_mean, <span class="at">group =</span> Sub),</span>
<span id="cb339-4"><a href="第十二讲数据可视化进阶.html#cb339-4" tabindex="-1"></a>                     <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb339-5"><a href="第十二讲数据可视化进阶.html#cb339-5" tabindex="-1"></a>                     <span class="at">size=</span><span class="fl">0.8</span>,</span>
<span id="cb339-6"><a href="第十二讲数据可视化进阶.html#cb339-6" tabindex="-1"></a>                     <span class="at">color=</span><span class="st">&quot;#000000&quot;</span>,</span>
<span id="cb339-7"><a href="第十二讲数据可视化进阶.html#cb339-7" tabindex="-1"></a>                     <span class="at">alpha=</span><span class="fl">0.1</span>)</span>
<span id="cb339-8"><a href="第十二讲数据可视化进阶.html#cb339-8" tabindex="-1"></a></span>
<span id="cb339-9"><a href="第十二讲数据可视化进阶.html#cb339-9" tabindex="-1"></a>s5</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-184-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>可以看到线和点的对应关系不是很好，线很齐而点很散，导致线的开头和点没有很好地对应在一起。那么如何使点和线正确连接呢？我们需要将点和线放在同一段代码下进行绘制，并且设置一致的dodge值，同时我们将个体值的透明度降低，让整体值的颜色更加凸显。</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="第十二讲数据可视化进阶.html#cb340-1" tabindex="-1"></a>s6 <span class="ot">&lt;-</span> s1 <span class="sc">+</span></span>
<span id="cb340-2"><a href="第十二讲数据可视化进阶.html#cb340-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df.match.plot,</span>
<span id="cb340-3"><a href="第十二讲数据可视化进阶.html#cb340-3" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> conds,</span>
<span id="cb340-4"><a href="第十二讲数据可视化进阶.html#cb340-4" tabindex="-1"></a>                           <span class="at">y =</span> RT_mean,</span>
<span id="cb340-5"><a href="第十二讲数据可视化进阶.html#cb340-5" tabindex="-1"></a>                           <span class="at">group =</span> <span class="fu">as.factor</span>(Sub)),</span>
<span id="cb340-6"><a href="第十二讲数据可视化进阶.html#cb340-6" tabindex="-1"></a>                      <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.08</span>),</span>
<span id="cb340-7"><a href="第十二讲数据可视化进阶.html#cb340-7" tabindex="-1"></a>                      <span class="at">color=</span><span class="st">&quot;#000000&quot;</span>,</span>
<span id="cb340-8"><a href="第十二讲数据可视化进阶.html#cb340-8" tabindex="-1"></a>                      <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb340-9"><a href="第十二讲数据可视化进阶.html#cb340-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> df.match.plot,</span>
<span id="cb340-10"><a href="第十二讲数据可视化进阶.html#cb340-10" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> conds,</span>
<span id="cb340-11"><a href="第十二讲数据可视化进阶.html#cb340-11" tabindex="-1"></a>                         <span class="at">y =</span> RT_mean,</span>
<span id="cb340-12"><a href="第十二讲数据可视化进阶.html#cb340-12" tabindex="-1"></a>                         <span class="at">group =</span> <span class="fu">as.factor</span>(Sub)),</span>
<span id="cb340-13"><a href="第十二讲数据可视化进阶.html#cb340-13" tabindex="-1"></a>                     <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.08</span>),</span>
<span id="cb340-14"><a href="第十二讲数据可视化进阶.html#cb340-14" tabindex="-1"></a>                     <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb340-15"><a href="第十二讲数据可视化进阶.html#cb340-15" tabindex="-1"></a>                     <span class="at">size=</span><span class="fl">0.8</span>,</span>
<span id="cb340-16"><a href="第十二讲数据可视化进阶.html#cb340-16" tabindex="-1"></a>                     <span class="at">color=</span><span class="st">&quot;#000000&quot;</span>,</span>
<span id="cb340-17"><a href="第十二讲数据可视化进阶.html#cb340-17" tabindex="-1"></a>                     <span class="at">alpha=</span><span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb340-18"><a href="第十二讲数据可视化进阶.html#cb340-18" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;RT&quot;</span>)</span>
<span id="cb340-19"><a href="第十二讲数据可视化进阶.html#cb340-19" tabindex="-1"></a></span>
<span id="cb340-20"><a href="第十二讲数据可视化进阶.html#cb340-20" tabindex="-1"></a>s6</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-185-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>这时就可以看到连接在一起的被试的点和线。这是ggplot画图的一个好处，当在同一个图层上叠加position和dodge时，不同几何图形之间的抖动错开是会进行自动对应的。同理可得ACC的图如下。</p>
<p><img src="_main_files/figure-html/unnamed-chunk-186-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>包含了个体数据的图信息更为全面，并且方便我们去判断实验操作的真实效果。可以看到虽然对于实验来说整体操纵是有效的，但对每一个被试来说心理学的操纵并不一定是有效的，数据在不同被试间的变异性是很强的。这和前面几章讲到的层级模型的思想是一致的，即既要捕捉整体趋势，也要捕捉个体趋势。</p>
<p>我们继续使用patchwork进行拼图，然后保存为pdf，保存的时候可以调整图片的宽高，因为pdf保存的图片是矢量图，因此用于投稿或者插入文章都是可行的。</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="第十二讲数据可视化进阶.html#cb341-1" tabindex="-1"></a>s9 <span class="ot">&lt;-</span> s6 <span class="sc">+</span> s8 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span>
<span id="cb341-2"><a href="第十二讲数据可视化进阶.html#cb341-2" tabindex="-1"></a>s9</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-187-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="第十二讲数据可视化进阶.html#cb342-1" tabindex="-1"></a><span class="co"># 保存为pdf更加清晰</span></span>
<span id="cb342-2"><a href="第十二讲数据可视化进阶.html#cb342-2" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&quot;./pic/chp12/p1.pdf&quot;</span>, </span>
<span id="cb342-3"><a href="第十二讲数据可视化进阶.html#cb342-3" tabindex="-1"></a>                <span class="at">plot =</span> s9, </span>
<span id="cb342-4"><a href="第十二讲数据可视化进阶.html#cb342-4" tabindex="-1"></a>                <span class="at">width =</span> <span class="dv">8</span>, </span>
<span id="cb342-5"><a href="第十二讲数据可视化进阶.html#cb342-5" tabindex="-1"></a>                <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
</div>
<div id="可视化层级模型的random-effect" class="section level3 hasAnchor" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> 可视化层级模型的random effect<a href="第十二讲数据可视化进阶.html#可视化层级模型的random-effect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>我们之前提到过层级模型的随机效应，这里我们简单展示了如何将每个被试random
effect中的截距进行可视化。</p>
<p><img src="pic/chp12/target2.png" /></p>
<p>我们选取12名被试的数据进行一个简单的建模，随机效应只加入一个随机的截距。</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="第十二讲数据可视化进阶.html#cb343-1" tabindex="-1"></a><span class="co">#此处选择12个被试是为了在展示的时候更清晰</span></span>
<span id="cb343-2"><a href="第十二讲数据可视化进阶.html#cb343-2" tabindex="-1"></a>sublist <span class="ot">&lt;-</span> <span class="fu">unique</span>(df.match.trial<span class="sc">$</span>Sub)</span>
<span id="cb343-3"><a href="第十二讲数据可视化进阶.html#cb343-3" tabindex="-1"></a>target2 <span class="ot">&lt;-</span> df.match.trial <span class="sc">%&gt;%</span> </span>
<span id="cb343-4"><a href="第十二讲数据可视化进阶.html#cb343-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Sub <span class="sc">==</span> sublist[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb343-5"><a href="第十二讲数据可视化进阶.html#cb343-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">factor</span>(Label, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;moralSelf&quot;</span>, <span class="st">&quot;moralOther&quot;</span>, <span class="st">&quot;immoralSelf&quot;</span>, <span class="st">&quot;immoralOther&quot;</span>)),</span>
<span id="cb343-6"><a href="第十二讲数据可视化进阶.html#cb343-6" tabindex="-1"></a>                <span class="at">Sub =</span> <span class="fu">factor</span>(Sub))</span>
<span id="cb343-7"><a href="第十二讲数据可视化进阶.html#cb343-7" tabindex="-1"></a></span>
<span id="cb343-8"><a href="第十二讲数据可视化进阶.html#cb343-8" tabindex="-1"></a>model <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="at">data =</span> target2,</span>
<span id="cb343-9"><a href="第十二讲数据可视化进阶.html#cb343-9" tabindex="-1"></a>                    RT <span class="sc">~</span> Identity <span class="sc">*</span> Valence <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span>Sub)) </span></code></pre></div>
<p>接着我们使用ranef(model)$Sub将模型中被试的随机效应提取出来，并对”(Intercept)“进行重新命名。标准差可以从variance
covariance
matrix中提取出来，因为只有一个随机效应，因此用sqrt(diag(vcov(model))[1]就可以直接提取然后开平方变成标准误。接着为了美观，使用arrange()进行排序，factor()用于将被试这一数字变量因子化，否则排序将会没有效果。</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="第十二讲数据可视化进阶.html#cb344-1" tabindex="-1"></a><span class="co"># 提取随机效应</span></span>
<span id="cb344-2"><a href="第十二讲数据可视化进阶.html#cb344-2" tabindex="-1"></a>ranef_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">ranef</span>(model)<span class="sc">$</span>Sub) <span class="sc">%&gt;%</span></span>
<span id="cb344-3"><a href="第十二讲数据可视化进阶.html#cb344-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Sub =</span> <span class="fu">row.names</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb344-4"><a href="第十二讲数据可视化进阶.html#cb344-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Intercept =</span> <span class="st">&quot;(Intercept)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-5"><a href="第十二讲数据可视化进阶.html#cb344-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">se =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(model))[<span class="dv">1</span>]),</span>
<span id="cb344-6"><a href="第十二讲数据可视化进阶.html#cb344-6" tabindex="-1"></a>                <span class="at">lower =</span> Intercept <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span>se,</span>
<span id="cb344-7"><a href="第十二讲数据可视化进阶.html#cb344-7" tabindex="-1"></a>                <span class="at">upper =</span> Intercept <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span>se) <span class="sc">%&gt;%</span></span>
<span id="cb344-8"><a href="第十二讲数据可视化进阶.html#cb344-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Intercept) <span class="sc">%&gt;%</span></span>
<span id="cb344-9"><a href="第十二讲数据可视化进阶.html#cb344-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Sub =</span> <span class="fu">factor</span>(Sub, <span class="at">levels =</span> .<span class="sc">$</span>Sub))</span></code></pre></div>
<p>接着我们使用ggplot绘制森林图。geom_vline()函数用于绘制x = 0上面的虚线。</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="第十二讲数据可视化进阶.html#cb345-1" tabindex="-1"></a><span class="co"># 绘制森林图</span></span>
<span id="cb345-2"><a href="第十二讲数据可视化进阶.html#cb345-2" tabindex="-1"></a>ranef_df <span class="sc">%&gt;%</span> </span>
<span id="cb345-3"><a href="第十二讲数据可视化进阶.html#cb345-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x=</span>Intercept, <span class="at">y=</span>Sub)) <span class="sc">+</span></span>
<span id="cb345-4"><a href="第十二讲数据可视化进阶.html#cb345-4" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb345-5"><a href="第十二讲数据可视化进阶.html#cb345-5" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmax =</span> upper, <span class="at">xmin =</span> lower), </span>
<span id="cb345-6"><a href="第十二讲数据可视化进阶.html#cb345-6" tabindex="-1"></a>                          <span class="at">height =</span> .<span class="dv">2</span>, <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb345-7"><a href="第十二讲数据可视化进阶.html#cb345-7" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb345-8"><a href="第十二讲数据可视化进阶.html#cb345-8" tabindex="-1"></a>  <span class="co"># ggplot2::facet_wrap(~ variable, nrow = 1) + # 按照对象分面</span></span>
<span id="cb345-9"><a href="第十二讲数据可视化进阶.html#cb345-9" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>()</span></code></pre></div>
<p><img src="pic/chp12/forest.png" /></p>
<p>森林图中点距离虚线的距离，代表的就是被试偏离整体intercept的多少，例如7313被试intercept和整体偏差了100ms的反应时，这在反应时上是一个相当大的差距；再比如7313和7314被试的intercept差距达到了200ms，这是一个更大的效应，足以说明被试之间的差异是很大的。</p>
</div>
<div id="雨云图rain-cloud-plot" class="section level3 hasAnchor" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> 雨云图（rain cloud plot）<a href="第十二讲数据可视化进阶.html#雨云图rain-cloud-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>为了进一步展示数据的分布情况，可以使用雨云图来进行展现。当研究者提出呈现个体数据重要性的时候，雨云图得到了广泛的引用，这一小工具甚至可以说改变了整个科研界使用可视化的方式。
<img src="pic/chp12/target3.png" /></p>
<p>雨云图的代码讲解在此不做赘述，请读者自行运行下面这些include=FALSE的代码。</p>
</div>
</div>
<div id="高级图片处理magick" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> 高级图片处理–magick<a href="第十二讲数据可视化进阶.html#高级图片处理magick" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ggplot生成的图像有时需要进一步手动修改（如修改图片格式、图片拼接等），也可能需要批量修改一些通过其他途径得到的图，R仍然可以处理：magick包可以应用于所有常见图片操作(甚至包括PDF)，具体功能可以参考相关文档(<a href="https://search.r-project.org/CRAN/refmans/magick/html/magick.html" class="uri">https://search.r-project.org/CRAN/refmans/magick/html/magick.html</a>)，在这里我们仅以图片剪裁与拼接为例。</p>
<p><img src="pic/chp12/r.jpg" /></p>
<p>假设我们希望这两张图变为横向排版，那么首先需要对图片进行剪裁，然后进行横向拼接。</p>
<p><img src="pic/chp6/pr1.png" /></p>
<p>首先我们读取和查看这张本地图片的信息。</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="第十二讲数据可视化进阶.html#cb346-1" tabindex="-1"></a><span class="do">## 读取图片；图片可以是本地，也可以是图片的网址链接</span></span>
<span id="cb346-2"><a href="第十二讲数据可视化进阶.html#cb346-2" tabindex="-1"></a>img <span class="ot">=</span> magick<span class="sc">::</span><span class="fu">image_read</span>(<span class="st">&#39;pic/chp6/pr1.png&#39;</span>)</span>
<span id="cb346-3"><a href="第十二讲数据可视化进阶.html#cb346-3" tabindex="-1"></a></span>
<span id="cb346-4"><a href="第十二讲数据可视化进阶.html#cb346-4" tabindex="-1"></a><span class="do">## 查看图片相关信息</span></span>
<span id="cb346-5"><a href="第十二讲数据可视化进阶.html#cb346-5" tabindex="-1"></a>img <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_info</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 7
##   format width height colorspace matte filesize density
##   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
## 1 PNG      870    977 sRGB       FALSE    92033 72x72</code></pre>
<p>下面需要根据图片的width 和 height
，使用<code>magick::image_crop()</code>进行裁剪，geometry参数接受一个字符串，来对剪裁区域进行定位，比如<code>"850x480+10+10"</code>。这个字符串包含两个部分:
第一部分：包含图片剪裁的长和宽（单位可以是百分比，但下面会使用像素），即<code>"850x480"</code>（注意：其中连接符为小写字母x），大概指右图中红色线条;
第二部分：包含起始点位置，即<code>"+10+10"</code>，意思是从左上角顶点向右10个像素，向下10个像素，大概对应右图中灰色点的位置，如果不写默认使用<code>+0+0</code>（即左上角顶点）。</p>
<p><img src="pic/chp12/crop_gram.jpg" /></p>
<p>我们使用下面代码对图片进行剪切。</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="第十二讲数据可视化进阶.html#cb348-1" tabindex="-1"></a>img <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_crop</span>(<span class="st">&#39;850x480+10+10&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-192-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>接下来我们将下半部分的图也剪切下来，然后进行拼接。</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="第十二讲数据可视化进阶.html#cb349-1" tabindex="-1"></a>img1 <span class="ot">=</span> img <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_crop</span>(<span class="st">&#39;870x488&#39;</span>)</span>
<span id="cb349-2"><a href="第十二讲数据可视化进阶.html#cb349-2" tabindex="-1"></a>img2 <span class="ot">=</span> img <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_crop</span>(<span class="st">&#39;870x488+0+485&#39;</span>)</span>
<span id="cb349-3"><a href="第十二讲数据可视化进阶.html#cb349-3" tabindex="-1"></a><span class="do">## 使用image_append进行拼接，令stack = F进行横向拼接（T为竖向）</span></span>
<span id="cb349-4"><a href="第十二讲数据可视化进阶.html#cb349-4" tabindex="-1"></a>img3 <span class="ot">=</span> <span class="fu">image_append</span>(<span class="fu">c</span>(img1,img2),<span class="at">stack =</span> F) <span class="co">#&lt;&lt;</span></span>
<span id="cb349-5"><a href="第十二讲数据可视化进阶.html#cb349-5" tabindex="-1"></a>img3 <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 7
##   format width height colorspace matte filesize density
##   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
## 1 PNG     1740    488 sRGB       FALSE        0 72x72</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-193-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>magick还有一些其他的功能，可以参考下面的代码。</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="第十二讲数据可视化进阶.html#cb351-1" tabindex="-1"></a><span class="do">#### NOT RUN ####</span></span>
<span id="cb351-2"><a href="第十二讲数据可视化进阶.html#cb351-2" tabindex="-1"></a><span class="co"># 保存图片到本地</span></span>
<span id="cb351-3"><a href="第十二讲数据可视化进阶.html#cb351-3" tabindex="-1"></a><span class="fu">image_write</span>(<span class="at">image =</span> img3,<span class="at">path =</span> <span class="st">&#39;your path&#39;</span>)</span>
<span id="cb351-4"><a href="第十二讲数据可视化进阶.html#cb351-4" tabindex="-1"></a><span class="co"># 修改尺寸(可以以像素为单位，这里以百分比为例)</span></span>
<span id="cb351-5"><a href="第十二讲数据可视化进阶.html#cb351-5" tabindex="-1"></a><span class="fu">image_scale</span>(img1,<span class="st">&#39;40%&#39;</span>)</span>
<span id="cb351-6"><a href="第十二讲数据可视化进阶.html#cb351-6" tabindex="-1"></a><span class="co"># 旋转</span></span>
<span id="cb351-7"><a href="第十二讲数据可视化进阶.html#cb351-7" tabindex="-1"></a><span class="fu">image_rotate</span>(img1,<span class="dv">90</span>)</span>
<span id="cb351-8"><a href="第十二讲数据可视化进阶.html#cb351-8" tabindex="-1"></a><span class="co"># OCR(这里以英文为例，中文的识别率经测验确实不太行😢)</span></span>
<span id="cb351-9"><a href="第十二讲数据可视化进阶.html#cb351-9" tabindex="-1"></a><span class="fu">image_read</span>(<span class="st">&quot;http://jeroen.github.io/images/testocr.png&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb351-10"><a href="第十二讲数据可视化进阶.html#cb351-10" tabindex="-1"></a>  <span class="fu">image_ocr</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb351-11"><a href="第十二讲数据可视化进阶.html#cb351-11" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code></pre></div>
<p>有读者可能会问，为什么要用magick而不用Photoshop来进行手工操作呢？第一，用代码可以实现精确的复制，不会每次都产生一点手工的误差；第二，加入实验过程中又收了一个被试，实验图片发生了一些微小的变化，如果用PS就要全部手工操作一遍，而用代码只要原样跑一遍即可。</p>
<p>这里也提供了一些ggplot2的参考网页，读者可以自行阅览。</p>
<ul>
<li>ggplot2常用参数与函数汇总：<a href="https://zhuanlan.zhihu.com/p/637483028" class="uri">https://zhuanlan.zhihu.com/p/637483028</a></li>
<li>ggplot2位置调整参数：<a href="https://zhuanlan.zhihu.com/p/409489632" class="uri">https://zhuanlan.zhihu.com/p/409489632</a></li>
<li>ggplot2主题总结：<a href="https://zhuanlan.zhihu.com/p/463041897" class="uri">https://zhuanlan.zhihu.com/p/463041897</a></li>
<li>ggplot2分面总结：<a href="https://zhuanlan.zhihu.com/p/225852640" class="uri">https://zhuanlan.zhihu.com/p/225852640</a></li>
<li>patchwork常用功能：<a href="https://zhuanlan.zhihu.com/p/384456335" class="uri">https://zhuanlan.zhihu.com/p/384456335</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="第十讲回归模型三广义线性模型.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="第十四讲心理学元分析入门.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/1012-lesson12_2024.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
